// 3714. Longest Balanced Substring II
// https://leetcode.com/problems/longest-balanced-substring-ii/

struct Solution;

use std::collections::HashMap;

impl Solution {
    pub fn longest_pair_balanced(s: &str, x: char, _y: char, z: char) -> i32 {
        let mut ans = 0;
        let mut x_count = 0;
        let mut y_count = 0;
        let mut mp: HashMap<i32, usize> = HashMap::new();
        mp.insert(0, 0); // initial position for diff = 0

        let chars: Vec<char> = s.chars().collect();

        for i in 0..chars.len() {
            if chars[i] == z {
                // when encountering the third character
                mp.clear();
                mp.insert(0, i + 1); // reset the starting point
                x_count = 0;
                y_count = 0;
                continue;
            } else if chars[i] == x {
                x_count += 1;
            } else {
                y_count += 1;
            }

            let diff = x_count - y_count;
            if let Some(&pos) = mp.get(&diff) {
                ans = ans.max((i - pos + 1) as i32); // found a substring with equal counts of x and y
            } else {
                mp.insert(diff, i + 1); // record the first occurrence of this diff
            }
        }
        ans
    }

    pub fn longest_balanced(s: String) -> i32 {
        let n = s.len();
        let mut ans = 0;
        let mut fre = 0;
        let mut a = vec![0; n + 1];
        let mut b = vec![0; n + 1];
        let mut c = vec![0; n + 1];

        let chars: Vec<char> = s.chars().collect();

        for i in 0..n {
            a[i + 1] = a[i];
            b[i + 1] = b[i];
            c[i + 1] = c[i];
            if chars[i] == 'a' {
                a[i + 1] += 1;
            } else if chars[i] == 'b' {
                b[i + 1] += 1;
            } else if chars[i] == 'c' {
                c[i + 1] += 1;
            }
        }

        // CASE1: one letter
        let mut letter = '-';
        for &ch in &chars {
            if ch != letter {
                fre = 1;
                letter = ch;
            } else {
                fre += 1;
            }
            ans = ans.max(fre);
        }

        if ans == s.len() as i32 {
            return ans;
        }

        // CASE2: two letter
        ans = ans.max(Solution::longest_pair_balanced(&s, 'a', 'b', 'c'));
        ans = ans.max(Solution::longest_pair_balanced(&s, 'a', 'c', 'b'));
        ans = ans.max(Solution::longest_pair_balanced(&s, 'c', 'b', 'a'));

        // CASE3: three letter
        let mut mp: HashMap<i32, Vec<usize>> = HashMap::new();
        mp.insert(0, vec![0]);

        for i in 0..s.len() {
            let diff = 2 * a[i + 1] - b[i + 1] - c[i + 1];
            if let Some(indices) = mp.get(&diff) {
                for &idx in indices {
                    if (a[i + 1] - a[idx] == c[i + 1] - c[idx])
                        && (a[i + 1] - a[idx] == b[i + 1] - b[idx])
                    {
                        ans = ans.max((i - idx + 1) as i32); // later indices won't produce a longer substring, so break early
                        break;
                    }
                }
            }
            mp.entry(diff).or_insert_with(Vec::new).push(i + 1);
        }
        ans
    }
}

#[cfg(test)]
mod tests {
    use crate::medium::longest_balanced_substring_ii::Solution;

    #[test]
    fn test_longest_balanced_1() {
        let s = "abbac".to_string();
        assert_eq!(4, Solution::longest_balanced(s));
    }

    #[test]
    fn test_longest_balanced_2() {
        let s = "aabcc".to_string();
        assert_eq!(3, Solution::longest_balanced(s));
    }

    #[test]
    fn test_longest_balanced_3() {
        let s = "aba".to_string();
        assert_eq!(2, Solution::longest_balanced(s));
    }

    #[test]
    fn test_longest_balanced_4() {
        let s = "abcbaacbcaacbababcbacacaabcccbabccabccaaabcbacccbbbaaabaacaabcbbaaababcacaabcaaacbbcaccbaccbacacaacccbaabbcacbcbccbacaabcbaaccacabbcaaabacacbababcccabbacaccbbbaaababbccccbaaaccaaabccbbbbcaacbcbccabbaaacbbbaacacabacaababcbbacabbbcccccbaabccbaacbbcbaabbcaacccccccbccacacbbaaabaaacabccbacbaccbcccaacccbacbcbbabbaaccbabbabbbacbbabbacabcbccaaaccbababccaaaaaabcbcbabbcbabcaaccabbbbbaabcabbacaabbabbbbccbbabbbccacbbccbaabbccaacaaabcaccacbaacaaaccbaaacbacbaccabbcbacbacabaabbcabbcaabbaaacababcabcabacccabacccbacbacacbbbaabababbcbcabaccbcaaccaaccbbacaaaccbaaccabbcbbaacabbcccaccccbcbacaccacccbaccbcbbbabcbcacccacaacacbbaabbbcaacbbccacacabaaaaaabcabaaacaccccccbbcccbbcaacbacabcbcbcacbaaababcacbacbacaabbaababbbbabbbbacbaccbacabbcaaacbcabbbbaaaaabbbbbbabcccaaabababaabcbcaabcbaacbcccbbcccccbcbacbaaccababbabbcbbcbbccbccbcbbbaaaacbbaabcbacababaaccbcbabacbabcccaccabacbcccbcaacbbcabcbcacbaaaaaccbcbbbbbabccaababcbbcacaacbaacbcabaaacccbbbaaabccbcaaccaccacbacccacabbccccbaaccbcaaacacaacaabbcccccabcbcabbcbcbcaaaaaaacbababcccabbabbaabccbacbbbbabbcabaccbbaabacccccbbacbbccabbbcabaaaccbacacbccababcbbaaabbbcacacbabcbcbaccacacacbcacacacaacbabacbccbccccacbcbacbbbcccccbacbbcbbccaabaacbaaacbbacaccacaabccaaaccbbaababcabaabbbabcacbacbbbcabbabacaccccaaaabcaacaaccbcaaabaccaabaccacaccccbcccaccccbcabbabbbacbababacabcabacabbbbbcbacacaabbaaccacbcaaccabababbcbcbacbbbaabccbaaccccacaababccccbcabcbbababcbbbcaabbacacaaacabaabbabbcacabcbacaccabcbbcaacacccbbaccaaccbacbaccabacccbbabccaabacbabbabcacacbaccacbbcabcaabaacaaccacabaccccbbbcbcbccababcaccaaccabcaabbcacaacacaccbacabaacccaacacabccacbbbbcaaacacbcabcbbbacccbbccbcbcbcbaccaccbababaccaacccbaccbcabbbaabbacbcbcacbbaccbccacccabacbabbaabaabcccbaaccbaaacbccaabcaccabbccccaacacbaaaaacabacbcbaaccaaabbbcbacbcaccbccaabbabbcacabbcccbbaaccbbcccccaaacaacbaabacaacacaccbbbccaababbcbacbacaaaccbbaaabaabcbbbbacaaccbcbbaabcacbcacababbbcccbbaacbcccaccababcabbccabacbcbcabcbacbacabbcaaaabbaaacacbaaaccaabaaacacbaccbbaabcbaababccbcbaaaacbabbbcccbcabaaccaabbaaaacbabacaacccbccacaaacbcbacbbbcabcccbcbcbccbbacccabaaaaacaacbbabaacaccccabaaaabccbcbcabbccabcbacbbacccabbacaacbaaacabbccacbbcaaacbcbabccacbabbcabcbaabbbabcaacbbbbcabbcaaaabaabbcbcbbbcbacaacccbbaacaccaaacbbccacaccabacbcbbbaacaabbbbacaccccbcbbccabaacccaaccccbcbcaacabbaaccababcbaabcbbbccaaaaccaabbbacbaacbacbaabaaababbcabccbccabbccbbcabbccbbcabbbaaaaccacccaabbbaacbcaacbcbcacbcaaabacbccaccccccaaacaccccbaccbaaccccaacbccccacccbacbbacbbcccaacaabbaaccabbaaacccabcbccbbbaccbcabccabcbbabaacabbccabcaabaacbaabacaaaccccbcbcbbccbbaacacccaccbaaabaaabbbbcbaaacacbcaabccbcabbaaaaaccbbcbbaabccaaaacbbbcbbccacbbacabaaaabaabbccbbccaabbaaacccababaabbcccbcbabbaabccacaacaccbabbaabaaaaccacbabcbcacbbcacabbbccbacbcaaabaacacacccbabababacabbaccbacabbaaccaabbcababcbbcaacbbcccbabbabbacbbaaaaacbcbbcaaccbbbaacbbcabacaabcbcaccacbbcacbccacabcbcaccabacbccbabaabcccabbcaabcabaacccbcbacbcccbcabbcaccbbbaaaccaaacacbbbcccbbbccbaabcaacacbccccacababbaabcbcaaabcbabcabcccbacbacacaccacaabbccaacacbccacacabcbbacbabbaaabacbccbcccbbacbcbbbbcacacacbccbbbbbbabbbcbbbcbcbbaacaabbccaaccccbabbcaabacaccbcbaaccabacaaccbcbaacaacbaacababcbcbaccabbaacbaaabcacabaaaabbbaaaabcbccacacaaaacccbbbcbcbbaaacccbbcbacaacbccaaaabcbcacccabbaabacaabbacababcaabbbaaaabcccaaabaacccbcabbbcccbcabbaccabaccccbabcbbcbaccacaabacaaccbbbbabacbccbbbaccababacaaacaabbbaaaaabbbbbaccbbacabaababcbcabcccbcacccbaacacacbcacababbabacabcabbbacbccbcccccacbcbcccbacaabbccaabbcbcaaacbbaacabbccbbbaaabaaabcaaacbaaabbcbbbccbbbaabbcaacbabcacbbcabcbcaaaabbbcbbabacbcbacccbccaaabaaaacbbccbababcbbaabaaacaacbbcbbcacabbaccacaaaaacabbbcacaaabbbbcabbcbcacbabaacbccaacaaaabbabbbaacbcbbcaabaccaaaaabaabbcbcaccbbacabaaccbbcbbbcbcababaacbabbcbbbbabbababbccbbbbabbabbcbcabbbcababaababcacbbbbcbcbbbbccccabcbcabcbcacbcabaaccbbabcacaaaacbabbcbabacbbbbcbababccbbabbccbcbacaccacacbcccbbabbbbccacbaabbaaaaaacacbbabcaccbaacacabbaccbaccbcccbabacbabcbcbabbcabaccacaaabbaccbabbcabcabacaabbcacacaacbbaccaccccbacbaaabbccbabccccabbacccaabbaaabaacbbbabababbaaaacccabbbaababbcacbcbcacccaacabbcabbbcaccbcabcbcaaacaaabbccabaaccacccaaaaaabcbaababaabbaaaaccaaabcbbaaaaacbcaabcabacbbbcbbcabbaccababccababaaacccacccaabbcabccccacbbbccaacbaabacacabcaabbcacbcabbbacbccabbaaabccabaabaccccabbacacbccabaaacbcbcaaabcababbacccccbccbaabacbaaaacbaabaccaaacacbabaaaacabaaabccacabaabacbcbbcccabbcacbcabcccaabbabbacbaccababcbabacabaabcaaaccabcbcabbabccbaabbbabcbabcbaabcacabaccabccacacaccbacbcacbbcbbcbcaabbabccabaaababcacabbbccbabbbbbccbabaacaaacaccccbbaccaacacccbabacbbaabccbbcbcbacbbccbaccbacaabaabcabcaccaaaaaabccbaabcbacaccabcbacaccbbbcbababcacbabbcacababcbaabcbcabaaacbacabcbbccccbcbbbbacbbbcbaabbbaabcaccabcbccabaccabcaaaaacacbacacbaacaabbcabccbabbbcccacccccaaaaabcbbbbbcaacbbcabcaacbaccaabbbaabbaabbabbcacabaaaacbbcbbbbcabbcabcbaabccbacccaccbacbcbaabbbaacbacabbaaabbccbcbabbacbaabccaaaccccccacaacbbaaacccccccbcbbbbacbacbcaccbcbabaccbcaaccaaccbccabbccabbcaccccaaaaaacaccbbaacbcccacacacbcbacbcbbbbccabcbabbbabacbbcaaaacabbcbbcbcbacaabcccaaccccaacaabbcaabcccbbaccaaaabcabaacbcabbcbbacbccaaabaaccccccbbabbabacbbaccacbcaabaacbccacbbccabcaacbbacbbccbaacbcacabaaaacbccccbaacababaccccacacbcbabcaacbaaacbcbcbcccbbacbaaacbaccbbbcacbaaacaabacbabcacbabcbccbaaababbbbacbbbaaaaabbcbbaacbacaabccacaabbbbaaccbabaacaaacbcccacbcbcabcccacaabacaaabaacbbbbaccaababccbaccaccababaabcaabbbcaabcbbbbaacacbbaacbcacabbaccaabcabccbaacbaacbcccbbacbbaaacabbbccaacbaacbbbbaabbcbcbbabbbabbaccaccabbacaabccaabccabaababbacccbcbaabbcbacccbccbabbbabcbcbcbaaabccacabacaaccbcabbcaabaccbcabccbababbbacbbaccbccabcbaabcbbcbbabacccbacbcabccbbcbacaaabaccccaaacbccaacabbbaaccccbcbacbccabbbaacacaccabccaacbabbbcbbabcbcbbaabbcbbbcbbcbbcbbaccbcabbabbcbcacaaccacabcbccccccbbccbbbcaaccaccaccaaaabbcbcbcbbaaababcccabcacabbcbabcccbabcabaaacaabbaacaaaaacabccbbcbbcaacbbaaacabbbccbbcbbccccaacaaacbbccacabbccacbccccabcbbacbacbcbaabaababbabbcaacbacaaabcbbbabbcbbccabbcabababbcbababababbacbcccbccacaccabbbccbccbaaaaccbbcbbabbacabcaccbbcaaccabaabacbabcabbbbcbccacaabbcacabccaaabcababbcabcbaacabaabbbaaaaaabbaacbcaaacccacbbbabcabcbabcbcbacabaacabbbaabbabbbabacaccbabbbabaaccacbcccbcaaaccbaaabacaccbbbcbabcccbbbcaabbbacbcabacbababcbbbabaabbccbabcabacbabaaabbccbabcbaccaacacacabaabaaaaabacacbacbcaaacaaababaaaacacbbcccaabccaccacabbbacbacbcaabaaaccbaacaabababcccacacaaacaabbccacaaabbaccbcaabbabcccabbacccbbcabaaaacaaacbcaaccccbccccbcbacabbabbbaacaccbcbabbbcbccbaaabcbacbbbbccccbccbaaaaabcaccabccabaaacaccabcabbabccabbbacaccabcabcaabbaaaaabcbbcaacccaabacbcacbbbcbcbccababaababcabbbbaaaacbabccccbcbbabaabbbacacbbbcabcbacbbbcabaccaaaaaccccacaacccaaacbaaabbaccbcacbcbcccccbccbcaccbacccbbbaaaaacccaabcbbaaaacbcacaacbaaacabcbaaaccbccbabaabcbcbbacbbabbccabcaccbbacbcbbbcaacbccbcabaaabcaaccbcbbbaccabcbcaccbbbabcccaaccbaccbbcaaabbcabcbbbbacccaaababccbaaccaaccabbcbacbaccaccbabbccaabbabcbabcbbbaabbbaccccaaabbcbacbcabcacaaabcbcacabacacaaacbabcccbacccabaabbcbacccacbcabcaccabbaabacbacccbaccbbcacbababbcbbbbbbbbbcabbaaabbcbcccacbbcbaabbacacababacbbbabbcabaaacaccbaabacccabaaccbabbbbcbcaccbabbbaabccacbcbcaccabccabbbaabbbbcaccbccbaaccababbcacacaccbccacbbbabbaacacbabccacbbbacbbcacbbabccbaccbaccabccbccacccbabccbccaaccbbbabcbbbaccbccbbcbcbaabbabbcabbbbaacbacbacaaabaacaabbbbabbaccaccbccbabbccbcbbcbbccababacacaaccbacaaccaaaabccccacbbbbcbbbaaaaaacbcccaccbabababaccabaaacbbcccabbcacbabcaaaccacacbaaabccabaccacbccacbabaccababbacbabbacccbcccaccbbcabaacbcbaaabaacbcabbabbabaabccbbabcbacbbcaacbbcbbacabaaacccacabbbccaaacccaacacccabccacbbbabaabbbcbbccbbbabbbbcbbcbacababacbcaaccacbacabccccbbbacbcabcacbabcababbbbcbabbcacccaabcbcccbbbaacccccacbaabcacccaccbacacbacbaabbcaccacabcbcccbbcbbacaaccabccbbcacacabccbbccbcccccabbcaacccbccbcabaacacacbcbabbacabccbcaaaccbccbaaaabbbbbabccbbabbbcbbccbcbbcbcababbbabaabaaabbaaccbaccaaabccbbccccaacaabbbaacaacaaaaaababbabcccbacccbcabcacccbbabaacbcacbaabbbcbaaccbbbbbbbacabcababbaababbbaccbbcacbbbacbcaccacabbacaaacccaabaababbbcaacaaaabbaabbabccbcbcbacccaacbbbbbaaabacbaacabbacbbaaaabacabcccbbcbbaaaaccccaaacababbcacbbaaaaaabacacabcaabbbccbccbbaaacbcbbcaccbcaaaaabbcbabaaabbcababbbcccbabcacaabbcbaaabaabbbcaacbcbbccbcbacabbcbabaabcaabcbccccaabbaaabaabbccbbcabaccbcccbacccbccccabcaaaaacbaababcabbabacaacabaaacbcccccacccacbabacbbabbcabbacbcacbbbcbbabcbaccccbcbbbccabcccacaccbbbbbbcabaaaacbabcabaccccacbbabcccaabccacaccaccacaacccaccaaacaaabbccbacccbcbcccaababccbacbabacacbabbbabcaabbcaaacbaaabbbcacbabccbaaaabcbacabaacbbbcaacaabbabcabbcabbccccccbbacaaacacbabbbaaaaccccbaacababbcbbcacabcaaabbcbaacaccbcbbbbcaccbbcbbcbbbcbccbacabcacbaccbaacabacaccbbaabbbaacabbcbccbbaacccaaabcbcaacbcaccbaaababbcaaacacccaaacaccaccaaaccabcbbbabbabacabcabbbaaccbabbcabbbbcbbbbbabaaccaabbabbcbcababbbbabcbabaccaaaccccaacbcbaacabcaabbcbbaaccacccbbcaccbacbccbcacabcbcacaaabccabcaaaacccbbbbaacbaaacbbaccccbbccaaaacccabccaccacbbbacbcbcbbbcbbacccaaababccaacbccbbcccccbbcbaacabccbcbcbcbabcbbbbacacacbcbabbbacccbcbcaabacbabcccabaacacbbcabbbabaacbbaabaccbbbacbbbcbccbcbbcbcacbcbbccbaaaacaccbccaacabcabbcbbabbabacbcaccbacacbaaacbcbcaacbbbcaccaaccbbcccccbabbabbaabbacbbabcabacbabcaaacccbbbabcabccbcbacbaaabacbbbcbababcbcabcbcbbbcbbcccccabcaaacbabbbaacbbacaacccbacabbbbacaaaaababcabbcbbbcbbbcaabcccccaababcaaccaaacbbbbbccaaababbccccacbccaabbaabbcabcccbbbbababacabbbbccccaacbcaccaaccbbabbcbbbbcaaacbcaccacacabccabbacbbbbababaacaccbcaccbbcbaacbccbaabbcbccababcabaaaacaacbccacbcabbcabcacaaaccabbbbbabcbcacccababaaaabccbcbbbbbaabcaccabaabcbccabaaaaccbbacaaacbbbbbcacbbbbabaabababbbaacbbbbabcaccbcacacabbbabaabaabcbaabcccbabbbcbbacccbabbbbbccbabcabcabacbbaccccbccaabaacacbabbaccccababcaaacbbbbbabbbaabbcbbcbbaacabaccbbbaacbabbbcaabcacabacbaabcabbbbcabbbabbcacbacbcaccabbcbacbbbcbcabccabbcaccaaaaabbaccbabbcacbbbcbbbbaccbbbbbcabaccbcbcccababaaaaccbaabbbaacabaacbbbbacabbcacaaaababccaccbcababbcaaccbcbbcaccabcacbababbabccaaacbababbcbbcbabacbababaacbcaaccccacbcacbbababaabbbbaaacbabcbbaabbbcaaaccaccbbccbbbabbcbccabaabbcbcbbaaabbabaaabcccccababaabcabccbbccabbabcaaaaaaabcccbbaaccbbaaabacccabaacbbabbabbaacaabcbbbabccbcabaaaaaaaccbcbccbbccccbbaaabacaaccccacaacacaaabbbaacccaacacabaacabaaacccbacbaabacbccaacababaaabbabbbbaccaabaccabacaccccbabaaaabbcbcabbbacbcaccbccccbcabcacaaaacbccbbaabcabababbbabcaabcacaaaabbbaabbcababbbcbcacccacaccbbabccbbabbccbbcbabcaaacbbbacacabacbbaaaccaaccacbbccacbacaacbacaababbcabcbbabacccbbaabaccaaacbccabbbcccbacbbaccbcabaccaacbabbcbbcbaaccbccbcabbbaaaabcacaababaacacabbbbbcababaaacbaccbbccaaccbbacbbcccbcbabaabaaacacacbccccbbabaababaaaccaaccabcbbccaacbbbbbbbcccbbbcbaaacacaccbbbcacccabaccaaacabacaaabcbbbabcbacccbcbcccbaaaaaacbaccbaccaacbbabccabbcaabacababbababbccbacbcaababbaaabbcbcabccaacabcbbcbcaccccaaabcccccbccabcacccabbabbbcaaabccaaaacaacacabcacababcbaaccccabbccbcaaabacbbaabbccbcbabaabaaaacbaccccaabcbaccacccccbbabcbcbaccbabcbbaaacccccccacbbbbababbaaacababaabbaabbbcaaabcbcbaccccbaacacbbcaabcacbabbbccaacbbacaacbccacbccccabaaaaacbacbacabbaaaaacbbabaaacbbbbcabbbbbabacacaacccacbcabcaaabcaababcabccabcbcaaaaccabcbbbbbaccabbcbaacbcacbbabbbccacaaccbbacaaacabaccbccaaaacacbabcacaabaaaacaacacccccbabbcbccaaabcacabbabbbaccacbcbbbbbccacaaccbbabccacabacccaacccbacbcaababcbaaababbbcabaccccacbcaabbcccababcbacbaaaccbbcbcbaaccbcaabbabcababcbbbbacabbbabcbcacbcbbcaaabbbccbcabbcbbbaabaabccbacbaaccaaaacbabacabcbbacbcbaacababaacbbcbaababaabccbcbcabbbbabaabccbaabaaababcbbcaaaabbcbabbccbaaaccaaccbacaaaacccbbacbbacccbabccbacaaaacabaccccbbcacbcccbccacbababcbbbbbcbaacaacabbcccaaaaacabbbcaaccbbbcaaacacbbababccaccbcbacccbbbccacbbcabbaaaacabbbcbcbabccbaccccbaaaccccbbacabbbababbabcacbcaccbaaababbaabcacbbcacbabccbcbacbcaaaaaabaabababcbacabcabcbbcbccbccacbaabcaacacbbcabcacbbaaaabaacbbcaccaacbcabccacabcbcabaaaaccabccccbcaccbcabaaaabcabbbbccbabaacbcaabacacaccbaacaaaccaacaacbbaabcccaabbacbbcbccacbabbaabbbabbccccbaababccacbbacaaacaaacbaaccabbaaccbcabcababccbbaaacaccbbaccbccbbcabbaabacacbbccabbabacbabaccaacccaaacacbbcbabcbbcabaaabaabbbcacacacbbbabbaccbaacaababbabbbbcbccccaacbaababbcaaacaaacaccabbbaabababccbcbbbbaabbbbcabbcbbcaacaabcacbacaabbabcccccbabccbcaacacbaccaaacaccabbcacbbabaaaaaabbacbcbccbcbcbbcbbbbabbabcbbbaccbabcabbbcbcaaababacabcbccbacbaaabbcccacaaaabaabaaccccbcacaccacbcaccabaaaabcbcccacabbcccccaacbbaacbcabcaaacbbaaacacabcabaaabccbabacccccbabacbbcbccccccbaccaacacabaaabccaaaacaabaababbcbcacbccccbcbbabbcbcaccaccaaaabaacbbabbcaccabcbacaccaaaccbaaaabccbabcababbcbabbcbbbcccccabccccbacaaaaabcaccabccbaabaabccbbaabcaabbbcbcbbababbcbaabcbcbbacbcacacccacbcbacabacababbabcbcbcbcaccaaccbcaabacbaaaabbcbbbabbabaacacccabbbaaaabbcabacaccbabbaccccaabaccbbabbbcbcabbcbcbcaccaaabaacacaccbcbccacccaccaacbbbbbabcabbcaacbaabbbcbacbcccacaaabbbbcbbbbccbbaaaccbabbaaaaccabaacbcaccbaaaaacacccabbbcbaacbabaabcaaaaccbbbabbabbacbabaccccbcaccbaacbbaacbbccabcbabbcccaaacacacbabbccabbabacbbcbabcbaacbbcaaabcacccccbabaaccccbbabaacaaaaaacbbbaabaaaabaaababaaaabbacaaccaccabbaccaccbcacbcbbbbbacaaccccbabccccaabaccbaccbaabaabababccbcaabaaaacaabbcabbbbccbcccbaacaabcbccbabcaabbcbaabaacbccabacacaccabbacacbcbbccabbcbbbcbbccbabcbbcbbbbcaaaaccbccbccabbabccbbaacbcaabcacacccbbabbbcacbbaabcbcccaccaaaababcbabcbcbacacaaabbaaccccabbababaacbcaabcccbabbbcbabacccbbaccbccabacacbccacbccaccbcbbcaaaacababaccabbbaccbbcaacbabcbbbccaccababbacabcbbaabcbcaccbbbbcbbaaabcaabbaabcacacabaababccaccaabbcaababbabccacabacacbbbbbccacccabcaabbbbabaabcacabbbacababbcaaccaaccbcabbbcbcbbbaacacbabbcccacabbbacccabbacaabacbbababbaaabbbabacabcababacabaabbbcaaccccacacabacaaaacbbaaabccbbabacacbbbcaacaababbcbcacaccbbcbabbcbcaacbbcaccbcabaacabbbbabbbbcbcacbcabcabacbabcacaaacbcbacbcaaacacccaccaacaabaaacabcbacaacccbbbbbabcababbbbbabcaaaabababacccbacaabccaaacbabaacabaaabcabcababbabbaacbbbcaccccaccaaabaabababcccaaaccabbbcbcabaaacacbbbabcbbcbcacaaaacbbcbbaacccabacaacccbcaabcaaabcbcacabbccbccccccbccaacabcaccbcbaabbbbcccbcbcbabbaacaaaabccccbaccbbbabcccaaccbacbcbcccabacbabcbbccbbcabaacacbcaccacbababcaaccabacaccaabcbacbbcabcabbbcabaaacbbbccbcccbcaaaacbaccabbbaaacbaaabbbcbcccaaabacccbbabbbaccacaabbcacbabcabcacaaccbaacbcbabcaabaaaccccacbbaacaacaacabcbbaabbbbcbaaabaaaccbbcaacaacbaacaabacbbbcbaaacccbbbabcccaababaaacabaaabcbabcababbcabcaccbbabcacacbbacbaaabacabcbcaccabcacbcbabbabaaaabcaccacbcccbacbabacacccbcacacaaaabbcccaaaacabcacbabbabcccbaacaccbbaaabacbabababaaacabbaabaabbbcbcaccccabbcacbcbaaaacbbabbacacaacbaacccbacacccbababacbcacacaaacbabccaabbaccbcccbaccacaaacacbcccbabbaacbbcacaacbcbbcbbbaabccbbbcbcababbbbaacaacabcbbcabbcbcbbbbcacabbaacbaccaacccbbaaaacaaacaabaaabcbaabcbcccbcaccbbbcbacbaccaccacbabaacbabbbbaabbcbacabacbaaabbaabaacabcacbacaabbcbbcbaaacacbcccaccbbcbaaaababbccbcababcabcbbabbcbaccbbbabbacaacbccbcbcabbcbabcaaaccbaabcbcababbcbaaaabbcacbbbcbccbcacaccaabbbbcbbbaacabbccabaabcaccbabacabacbabbbbacaabacabaabcbaabbbbaacbaaccbabbbaccbbacaaccbcbccbbcbbacaabaaaccabacbbbccbbccabaacbabacaababcabaccbcaaccbcaabababcacbcbacabbabbbabcaacacbaaccbcbcbcaabbaccbababcabacbababbbbbcbcccabbaaaabbacaaababbabcabcbcbcbacacccbbcaaacaaababbbacbcbaabbbcbabbacabacacaabbbcbabbbaaabaaabaaabababbababcbabcacaabccacbcaaacacabaaabcccbabbabbbcbaacbcacccacccbbaabbcbccbccaaaabcbacacbbaaccbaabbbcaacccccbbcabccaaabacabbcaabacbcabbbabcbbaabbacccacaacbbabacaababbbbbabbccbcacbbccaabbbacbbaaaabcbcbacbacbaccbcaccbbaaaacbababaccacccaaacaababbccabcaaaccbcabbccabbbbabccbbcbbaccbccbcaaababcbcabcacabcbccccbabacccabbcbcbbcabbbbbcbaccaaaaaaabaacacbcbcaccbccbcbabcbacacbaaaaabbccabbcccccacbcbbaaccabcccaccabaabbacbbbcbcaaaaccbacaccbaabbacccaabcbbbabbbaaccacaaaaabbcabaababbbccaaacaabcaaabcccabcbbacbbbcbbbcabbbcaaccbbbcbaccabcabccaaacaacbbbaccabbcccaacbacaacbbcabcaccabcccbcaaccaabccabbcaaabbabbaacaccbabababcbcbccbbabbacbbbcbbcbaacaacaaacccaaaaacbbabcabbcccbbbcabccbaccbbccccabaabbbabbcaaabbcbaacccccacbbbaaabaabcabcccbaaabbbbbbbabaaabcacccacaccbcbcccaccbacbbcbacccacbabbbaccccababcbcbcaaccabcbcbccbbbaaccaccaabcacbaccabcbbbaabcaacabcacbacbcbaaabcaccccbbabaabaccabbcacccacbcacaccababcaabcccbcabccabaccccababbcbcababaabcbbaabccbaccbbbaabaacacacacabbccbaccaccbbbcbcbcbbabbaaacbbaacbaaaaccbbacabaabaabbcaccbccabcacacccaacacbabaaabaccbcacbaabccbbbcbaabaaabbbacbcccabcbbcbacbbacbbccccbaaaacbbbaabbccabcbaccbccacbbabaccbaaacababbcaabbbbabaabbcaaaacbaaccbaccbbbccabcacaccbaabcbcbbaabaaccabbaaabcabbbaabbbbabcbabaaacacacaaaaabbbaccccccbaabccbbcacbcbbbbccbbabcabbbcabbbbcbbccaabcccbcccababbaabbaaacbbbaabbabcbabaccabbccccbacbacabccbacaabcbabbacabbbaabcbccbcbbbcabccbabbbccabcacccaccabbccbabcbbcbaaaacbcccabbaabbbbbbccacbccabbccbcbcaaccbabcbcccabacacbaacaccbcaaabbabccbcaaaabbbacbabbbabcccbbcbaccbcbbbacaccbcbbcabaaabacbacbbbcaacbccbbbbccacacbbaccbbaaccababaaccccbbaaacacbcbbaaabccbcbcbabcbcbbcbbbbcabaabababbcbaacbbbbbacaccaaaaccabacbaabbbbbaaaacbcbbaacbcccbacbaabcabcbabaaabcbcacacacccabccbccbabaabbacabcbaabcccbbcbbcacbccbacacbcababccbcacccaacababcacabcaccacabbcccbabcaabacaaaccccbbbacacbccbbbcccabbcbbaacbcabccccccaabcbbbacbacacacbcccbbcacbcbabaccaccacaabbaccabbbaccbbcabbacbbaccaccbcbabcbaccaabccbcbaaaabbccaacbbababcabbabacaacccbaacaaccaacaccbabcbabaabbababbbacbcabcacbbabaacbabcbabcbbbaacaccacbacbacacabbaaaacbbaccbccccbababaacabccbaccaabbbbccaabbccacbcbbaabcbbacbcabacaabaccaaaccabbababaacabccabcccccbcabbbacccaabbbabcbbcbacaccbacccaccbcbcbbbbccccccbbbcabccbcbbcaacacbcaabcaccccbcccaacaaccaccccbcbbacbcaccbaababaacbbcbababcabbbcaaacacbbcbccbabbccacbccaaaaabcccbbacbabcbcaccacabcacbbabbcbabbaaccccbbcaabbbcbbccabccabbcbbccccbbbcaabbbaccccbcaaccaccaaacbbcbbbaacccabbaacabbbaaccbabcbaaaacbcaababbcaabacbccccabccbaaccbbabaaabccccbaabbbcbcbbccacaaaaaabcbccbcaccccacbaccccacccaccccbbbcaaaaaabacbabcbcbcbbbbabccacbbacaabccabbcbcabaababacaacbccccaacbccabbbbbbbbcabbaaaccbbcbcbabcbcabaccccbcabaabbbbbbbacaaaabcabababcbbaccccabcacacbabbcbccbcccabaaccbccacabcaacccbaccacbaabbaacbcbaccccbabcbccccabbcccbccaccbcaaccbbbbbbbaaaaababccbbbaabbcbcbcaabbcbccacabcabbbcacbaccaaaaaccaabaacacbabcbabccaabccabacbcbcccaccbbacccccbbcabacabacacbcbaccabacbaabcccccccbacbbbcabbccbacabacccbcccbcbabccccaabcbcccbcbaacccbacaaccbbaaabaaabcacaacaabbbcacaabbcaabcbbcaababcbbbbcacacbcaaccccbcbcaaabbcbccaababaccbaabbcbcacbbbbccccbacaababacbbbcaccccabccaccabaabbbacaccbababaccbabbaacbcaaabaaabcabcbbcccaaaaabbbaaaacaaaaacbbbbcbbbacccccaaaacaccbbabaaabccbababaacbabbcbabccbbabbcbcbcbcabcbcaabbcacbaaacaabababaaabbcbbbabcbaaaacacbabcacacacbcbbbabbcabbbabaaacbccaabbcacabbccabbabbcabbaacbaacccaabacbaaaccbbbcbaaaccbcbabaacaccbcccaabbbbcabcbcbbcacbaababbbcbacbbabccbbbcccabcabbababbbacacbcaccaabbaaaabcccaccaaccbbccbabacacacbaaacbcacaacbbbccbcbbbbbaacbcbabaacbccacbabbcccbccacbacacccbbbbcbacbbbbcbcbcbbcabcbbbababbbccabaaccccaababbbacccabaababcaacbcabbaacacacacccccbccbcbccabcbcbcccccaacbbbaccacababacbcaccabacccaccbaacbaababbccbbcbcbcbcaacababbbbcbacbbcbaaaaabaabcbbabcabbcccaabacacbccccabaacaaabccbaabcbcbbccaaaabaababcacacabcbbcbaabcbcacacbacbccbbccbcccaccbbbcbaacbbccabcbcbabacccaabccbbacbbccabcabcbbaacbcabccbbccbbcacabcabacbaccbbbcabaccbabacbacccbabacbacaaabcacbccbcbccccaacccbbaacacbccbcbabababaccbbcabcccbbabccacabaacbcbbabaabaacabbacbaacaabcacaacbaacaccabacabcbabbcacababbababcbacabcaaacabaacbbccbcbcabbacaccccacbbbbbabbccaccbbabbbccbcabcbaabacacbbabcaabcbacacbacaaabcbacbacacaacccbcbbbccbccbcabcabccbacbbacacabcaabbcaccbbcabaacbcacbcaacbabacaaccbacbacbbaaaabababaababbbaccabbbacacbabacabbbacbaaabccbcbcabacaaacbcaaabbaabcbcbaabcabccacaaaacaaaccbcbacaaabcaccaabacbcbcbbbccbbbaaaaacaccaccacaccabacbaacaaabccbcbcbbacabaacbacbcacaacabaaabacbacbccabccbbccbaabababbacacaccabbbccbbaaabccbcaabaaaabcbbcbcaaaccbcabbbcabcabbbacaaccaacbbcbbacbcbaaccccbabbbbcbbcaaccacabbbcacbbacacacccabcabcaababccaaacbccbabaccbcabbcbcaabacacbaaaacabaacabacaabacbacaccacccbaaabcbabcaccaabcacacbccabaabbabcbbbcabcabccccbcbbacccaacabaccbcbababababbacbccbacccaabbcbbcacbcbaaaabcbcbacbaccaccbcabbabacbabbcaacaabbcccaccbccbcbbbaccabccbcaabcccacbacaacaacabcbbccbacbaacbbccbaacbabaccbabaacbcbbccacbcbcbbbccaccaabcabbacbaacabaabbabbabababacacaacbaaabbcbacbccabcaabcbcaaccabbabbaacabbbcbaaacccacacaaabbacbbabccacbaccaccabaabccacaccbcabbaacbcbacccabbbabccccbbaaacbbbcbbcaacaabcbbbcbbabacaaabaacbacabacccbcaaabbbaabcaababbaccbcccccaccbacaabbbaccbcabbaccbbbacbbacbbccaccccbabacaaacaccaccbbbccabbbaaccbbaacbabcbcbaabbacacccabbacbbaacaabaacaccbbcabaacacaacbababacccbbabccbbaaaaabbaccbbbbccbaaacacaabbabbaabbccbcabbcacbccaaccaaaaccabcbccabbacaabacbccaaaacbcbcacaaaccaabbaabacacaccaacaabacaabbaababbcbabcbacccaaccaabbbbcbcacccbabcacacbbbbccbbcbbacabacbbaccbbaaccbababccbbbbbbabccaaacbbaacccbbaabbcabaabcbcaaccbacccccbcbcbacbcbacbacbaaabaccbaabbaabbbcbabaccaccccccbcbacbaabbaccbababcccbacbcbbababaabcacccbcabcbbababacacbbcbabbacbbbcbcabccbcabacbbccbabacbacabbabcbbbbcccbcabbacccbaababacacccacbbabaabacbbcababcbbccbacbcaaacbaabbabcaccbacacbaccbbcabccbaacbaccccacbbbccbccaacccbabcbbabbcaacbaacacabcaccbcbbabcabbbacaacabbcabcbabaacbccccbcbacccbabcaccbcbccabbbcacacaacaaaaaaabbcbccaacabbbabcbbaccabbcacbcaccabbbbbbbcabccccbcccbcacaccaccbccbaccbaaabaaaccbacaaccbacbaccbaccbacbbbaaaaaacbcaaaaaaaabbbabaccacbbaaabaaacbbcacbbcbbaccabbaacccbccabbcaabcaacbbaacbcaabbcaabaaacbaacbcabbbbacaacbabaacbabbcbbabcbbccacccbbbabccbcccbabbabbcabccabcbaabaaccacbbbbbbacbccbcabbcaacabaccabcacaaccbaababccbcbbaaabbcbccbabbacaccabbbacbbcbaaccaacccccbaccbbacbbaacccaacbacabcbcbccbacababaaabacbcabcabbbbabbcaacbbbbbccbaabccbaaacabcacaabbaccccccbcbcabbaaabccaabbcacbbccbcbbaccaaaaacbbcbcbacacbabcbabacaccaabbcaaaacbbbabaccaabccbcbccaacbcabccbbaaccabcbbbaaccbcccabaaabbcbbaabacabbcaaaccbcbcabcabaaaaaccbcaabbcbcabcccbbcccababcbcccbacccabababbcaccaccabcacabcbccbacaacaccbbbaccabcbcbbbcbbbcababaacccbacbacabbabcaaabaaaccacbacbaacccabccaabbcababbcabccacbbbbbbbcacaaccabcaabcccabcbcbccccbbcacbbcbacacaabbacbccaaaacccaccbacbaabcbacbccbacccacabccbaaacaaaabababbabbcabcbacabcaaacbcbbaacbbbbabbacababaabcaccaacccbbcbcbbaccaaabcbccabbbcbcacaaacacbabcbacaccaabcbaaacabbbbbacaccbaaabcbbbbbabacbaababbcbccbcaacbcbacbabcaaccbabbccbabbcbcbbcbcbbbcaaccabbbbbcbabaabcabaabbccbbccbaabcbbacaccbbbbaaaaabaaaaabccabbcbbaccbabbababcbbccbaacabbbcccbbcaaacccacaccbbcaabaacbbcaccaabcaaacbbcbaaababbacabccaccabbcbaaaccacbbcaabcbbbacbcabbbbcccbcababacbcaabbcccacbcacbabababbbcabcbcabacbcacbabacabcbbbcbacccabbaccabccaccbabaaaabcbccbcccbcabaaaabaaccccaabbcabacbbcacaccccbcaacbbccaacbabbaaaacbaaabccabcaabccacbbacbaabbcabbabcacccaccccbcaacacaabcbaacccabbbbcaabbbabacabacccccccbbabccbcbabccbaccabbabacbcbabaccccbbcacacbccaaabacbaacbacccacacbabcbabcbbaccbacbbacabaabbbcbbaabcabbcacbbcaabacccbabcbabbabaccabcbcaaaaabbacbccbcacacaaabacaccabbbbbccaacbbcccbabbbbaabaabbaabcabacacbcbacbaabcaccaaaabbbabbbaaaccacacacaabaabbbcbbaaaabbbacccacaaacccbbbbbcbabacacbcbcabaacbbbbcbbaabcabcbaaaccccaaaaccaacbaaabaccbccbbbccabbabbcababcbaacaaccbbccaccaaabcccccbababbbcaaabbbabcccccbaaccbcababbcbbbbbbbabccbaaabcacabbbbbbbbbbcabbcbacbcbccaacbbcccbabcabccabaaccacacabbbaccaacbcaabcbbcbcbaaaabbbbaaccbbaabcccbbccbcabacaaabcbbcbccabbacaacaacbcabaccaacbaccbbbcccacaaaabccacabccabbccabbccccabbccbababacccacccbbaabcacacbbbccbbacbbbaaacccabbabacccbaabccbbcaaacbaabccacaccacbcababcccbccbaabaccacbcacabbaacccbbcabbbcaabbbbaabcaccbbbabbcbabcaabaabbaacbbcabaacccbbbcbbbbbcbbbccbcbcbacacabbbabbbbcaaccaabaacbaababcccaabaaacacccbaacbccbccbcbbbbbbabcbababbcaabbacbabbaababbcbcbbbbcabbcbaababbbcabaaaaabcaabcaaccacaababbcbcccbccaaacabbcabaaaacccccbcbaaacaccccabbaabbbbabcaabababababbcaccabccccbabbabbbabbcbaaabacbbcacbbcbabbcbcaacbbccbaccaccaabcbaccbaccbcabbabccabbbacccaccbbcacbcbacabacbbcaacbacccaacabccababbbbcabaaacbbbbabbacbcccaabacbbcbbbabcaccbbcbbbbacabbcabbcbcbcbcccabaaccbababcaacaabbccaabaabcaccbacacbcaccbcbbccccabcaaacccacbabcbabaabcacbaaabbabbaabbacaaabcbababbcaccaaccbacccacbaacaacaaabccccacaababcbabaacbacbcabbaababbbbabbaabaccabcacbbaccbabbcccbabaacaacaabccbcbbcbbabcbbcbcbbaaababacbaababcbaacbbcccbbababcccabcaabccbcabbbbcbbacaaaabccbccabccbacccaccaccbccacbbcbbaaabccabaaabcbcbbccccbbcacabbbcabbabcaabacacbbbbbbccabcaccacbbbbaaaabbbabbabacaccccbacbbcbaccbbbbcbcacaabcbaacabccbbccbacaaababbccbbbcabbcacbaaaaacbbcbbcbaaaabbbcccbcacbcbbcabaabccbbcbbabbacbaaaaabbcccabacbbabbbcababbbbacbabbbbcaaabbbccbabaacacbbaabcbbacccccbbabacbbcabcbbacabcbbbaccbbbabacacaaaccbbcabccbbcbcbcbbacbbbbbbccbbcaaabbbbbccbabcabacacacabacacbcacbbbcabcabcbbbbbcbacbaaccababbbabbbaccbccaaccbaababbbccabbaaccabccbabcacbacabbacccbaccaacbcbbaaaacacbbbcccbcabbccbacacccbccbbaaabcccbccbbabcbaaacbaababccbbbbaccbcbacacaababcccabbcaccaaacbcaccbcbbcacaacacaccbcbbcaababbcaacccabaabccccaaaaccbcabcbbcbbababbccabcbcbbcccbbbcaaaccabbacccaacbacbbaacbbcabbbabcccbacbacbbcaabaababbcbabcacabaabbaabacbcccbcabaacbababbcccabcaaacbacaabcabcaaaacabbbcbbaacbcbabaabaccbabccccacaaaccbbbcabaababbcaabacabaaaabacbbbabbaccbbcccbbbacbbabcbaccaaccbaabbbaabccbbcaababbcacbbabbaacaaabaaabababaaccbacaabbcaabaaacbcbbccccacacbccbccabbcabcbacbabaacaacccccbcbbaacbabcaabacacaabccbbbbccbbaacbccbbbcaababbbbcaccaccabccacbabcababcbbccbcacbbaacabbcbbcccacbbabacbbaababcaaccacabbabbabaabcbbbbbabbabccbaccbbbabcaabacccbcbacaacbaabaabcaaaabaabbabbcaaaabbbabcbccaabcbcacbaccccbacaaaacbacacccccaccbbabbaccccaacbbaabaaacacaabccbcaaabbbbccbcbaabbbababacccbcacbbcbcaacabaaababbaccaacaccbcbaaaaaccaacacbcbacbbaaaaabcaacbcbcbaabbacabcbaabcaabbbbaabcbccbcccaaabccaaaacccacacbbbbbcabacbaabbaccccacaacacccccbccbabcababccacabbacacbaabababcbccabcbaaacacbacacabcaaaaaaabaaabacccbccbcbaaabcbbcbacaaaaaaccaccacaaaaaccbcbbbcbbcacbccaaabcabbbaacccacbcbcacaaaaaaabbacccabaaccaaaaababaaccabcccbcbacbbabccacbbccbcaaabbbacabccbaabaccababcabcaccababbcacacbaacbbacabbbbcbbacbaaabcccabcacabcccbabccbbcbabcacbbccbccbaabbbbabcacaacababacbbcaabcabbcbcacbcaacabcaacabbccabccbbabaabbaababacbbaacbbbbaababaacabbcbacabcbbaccbabcabbacacbbbcbacaacbaaacbcbacbabcbacaacbbabaabcbabaabcabccabcbbcbabcbcaaaaccbabccbbccccccaababaaabacbabbbbcbcaccbbbaccbbaababcbbcccacaaaaaaaccacacabccabbaaabaabcbabaccbaccaacaabcbccbcbcbaaccaccaccbabbcbcbcacbacaccccbcbabbcacbbaabbcbbcacccababacbabccbbaccaacabcacacbbaaaccbcaaacbaabbbbbaabbbbbabcaabbccaccaacbbaaaaaaabaacbacaaaabcbbbaaaababacbcaabcbacbcacacacacaaabbbbbaccabbbbcbabaaccbaaaccbbccbccabacababaccbbbabbaabcbaabaaccccbbbbaccaacccccacabacbaaaabbbccaacabbacabcbaaccbabcacabcacbbbcccbaabababccaccacbacbccbbccacaccbccccaacabacccbbacbabacabacabbabcacbaaccbccbccccbabbcbcbbbccbcbcaacabcccbacbbbabbcbbacbcabcbbbcacaacbbaaabbaababacaacbbbcbcaabbcacbcabcccacaaacaabccabbccbbaabbacacabcaaaabaccaaacccbcabaacacbabacacaababcabacbcabaacbacbbabcacbccbaccbbcbaccbbbbccaaccbbabcbabcaccccacbaacabccabcbabaabbacbacaaccbcbbbacaaaabbbbbbabaacbcabaaabaacbbbcbaababcabacbcbbcacccbabbcccaccccbbbbbabaabbaaacaacbcccbbacbaaaccbabbacacbacccbcbbabbbabaccbbcbcabcbabbcbaacccccbccabbbbaabbbcaaacbacccbacccbbaccbcaacababcabcbbcbcabcbacacacbabaabcaaccaaccccaccacbacccacbccbbaacbcbbcccbaccbcccabbbcaccacbabcaccbacacbacaacabcbabcbbcabaaabbbaaaabcaacbabbaacbcbccbcaccccbabaaabbabbacbaccbbacbbababacaaaacaacccaacbccbbbccaaabcabbcacbbacabccbaabaccbaaabbaccccccabaaaabaaacccbbacbbcbaabbacacacabbacaabccbccbcbcbabbccccbccccabcaccacaabaacccbbacccccabbacacabbaabbaaccbcabbbbbaababccbacbaccacaaacbccccbbbbbbcaabbcbabaabcababcaaaabaccbcaaccaaaccbabaacacbcbcbccabcbacacaaaccbaaacbcaaabbacbccabaacabbccccbcabbcbaacbbcabbcacaaccacbbbcacacaaccccbaccbbbaaccbbccbacbaabbacccbbbaccccbacbbbcaaaaacaabbbbacbbaacbccbaabaaaccabcacaccbcccabccabbabcaccbacbababbcbbbaacbcbbbacbbcbcbcaabaaabbbcbcccaccbacabbaabaabbabbcbabcbacbbaccbbcaccbcaaaabcbcccbccccbcabaaacbaaccaaaabcbcbabbbcccacccacbcaccbbbaaabcbabbccaabcbcbbbacbababcbbabcaababaaccabaaabaccccccbccaccbbacacbaacaacaabaabacaaacaabcccbcabcabbcaaabcacacbbcccbbabcbabccababbaabcbacaababacccaacccbbabbbbaccbacbbcacaacaccbbaaabcabbaaccababbcbacbccbcbbcabacbacabbcbabbcbcbaaabbcaacbcacaabcccabbccbbcababbacacbacbccbcbcaaaacabaaaabaabbccaaccaaacaccabcacbccaabccbccabcbbaabcabacacbbbbcabaabaaacaacbbbccccbbbaccabbbccbcacccbccbbbcbcbbaaacbaccbaabbcacbacbaccacbacbccaabcbbaaccacaaabacabbbccaaccbbbcabbaaabacccacacaccbcccccbacccbcaaccbbacbacbabcbbbbaaacbaababbcabaaacacacbcacbbbbcaaababcbcaccbcbacaccaacacbaacbabbaaaabcbbacabcbbbcaacaaacacaccaaccaabcaabbbaaccbcabaccbbbcbaabbccccbbcaaacabcbbbcaaaaccbbbbbcaabcbaabcacccccaacaabbcbbcaacabcbacabcccaacaaaccabbcabcbcbbbbcbbbcacacabacacaaaaccabbbaabbcccbcbcaccacabaaacababaabccbabacaabccaabaaabbbabacabcaaaccababccaababcbabababbbbbaaccaabbabcbcbcacbaaacbbbcbaccbacaaabacabbbacaaabaacaabcaccacabaaabbbbcbbcbbcababaacbcaacbacbbbbbcacccacaabcaacccaccabaabaabcbaccbbcbacbcacbacccabcaaaacbbcbabbbcaccbbbbbaacacbcbcbcaaaabbccaaaabaccbaabcaacabaacbbccbbbacbcbacaacbabaabbcbaccbcbbcbcabbbabbccbbcbabcacabbacbcbbbbaababcabccbbbccbbbbacbbaabcabbabbcaabacbcbbccccacbbbbcccbcbbbaabccccbaacaacccbcacacbcccbabbbcacabbbccabaccbcabcccaabcbacaccabbabccbbcabbcbababaaaacbaaacbabaabacabcbcaaaabbaaaccbbababcbbccaaccaacaaccacbabbbcccbaabbcabbcbbcaababaacbccbabaabccabccbcababcbbaccbbbabacbabacbcbcaccabaccbccccaaacbbccbbacbaccaccbcbbcccccbccbbaccbccabbcaacccaccbbabaabcaabacabcccbacbacbccaabbcccbccbbaaacbccbcaabbbaacacabcabbaccaccbaaabaaccbbabacbcbacbccccbbaabcabbcbcaccaacbccbbccbbbbacbccccaabaabbcbabbbcabbabcbcbbaaacaabccaccbcaccaaaabcbacbabbcccbacbababcbaabccbbbcbbaccbabbccccbaabbcbbcbaaababacbcabaacbaabbbccacbccbacbccccbacbabaaabbccccacbaabcbcaccbbccababbccaccaaaabbcabbbbbbabaababccbcaabcbaaaaaabaabacacaacccaabacbcbbabbcbaabacaaaaccccaacbbccaaabbaacbccabaabaccabcbbcacabcbacbccbbcbcaccbbaaaccbbcbaccbbcbcbcaccccaabcacabbccaccabcccccababbacbbbabbbacabbbcacaabbacbbbbbabacbbbccbbaababaccbbbbbbbabccaaabbbbcbcacbbbbbbbcabcccacabbaaacabaaacaababbbccccaabcacaaaaabaabcbaccaacacbabcbccbccaccbbbabaaabbbaaaabcaacbabbaaccbacbbaaccbcbabcbbabacbbabacbccabcbccacacabacbabccaaaaababbaacbccacababaccbcabccabcacbbbbbccbabcacbaabcbaccccababcabbccabbbbcacbaccacaabcabcccaaacacbccacbbaabcabcbbaabbbcbaaabbaabbaabcbabababccbabccccaaaaabcccbbababccaccaabbabbccabccbbbbacaaabaacbbccbbbbbbaaaabacabacaaccbbaaacbbcbccbbacbcabbccaabbabbccbcbbacbaaabacbacababcacabccaabaccbbbbaaaabcbbabbaabacbcababacbacccaaabcabcbacaaacbaccbcaaaabccacaaacbbbbbcacaacaccaacabaccbccabbbccbbbccccbbaacabbbcaabacaabaccbaacabccbbccbbcbabbabccaccbccbbbccbccaabbccbcaccaaaacaacaccacacabbbcbaabbaaccabccaaacaabbbaccbcacabbaaacaaccbcaaabcbcbababbcbbabaaabbbccbcacabbcbbccbbbccbaabbbbaaaccbccccbbaaacacbbcccaaaabaaacacabbabcaaabccabcbccbcbcabbaccabcaaacbccaabbabaaacaacbaaacbbcabbabcbcabcbacaabbacccbaaabbcaaacacaaabbbbaabcbcbbbabacbabacaccbacbcbabbaababaccccaccaabacbaaabcaaccbaaabbaaacaaacaccccbcaabbcacaaabbacbcacabbbbcbaaabbbaabccabbaaaaacbbaabccbabacacaaccbaccaacabcaaabacabbcccbccbbabacbbabcbcbbababacccbbbcbccccccbabccabcabbccabbbbcccaabcbabaacacabccbababbaaabacacbaaaabbcbcbbabbccabccaababccacbcbccacbcacbccabacbaaacaccccbaaacbccbacbbaaaccabaaacacbaaabbcaaaaaaaababbbbaacbbcccbaabbbcccaaabbbbbcaabacabcabcaccabaccbcaacabbbcacbaacaaacabcccabcbbbbbaacabcbcccbcbbbabcbccabacabbaabbbbaaabaccccacacabbbbaacbabccbcbccbbacbbcacbbcabcabacababccbbbcabababccbacbbbccaacaaabccccccabcbbbbbacbccabbacbccababbbcbcbccababbcccaababbcababacbacaaababcccbcbaaabcbbcabbcbccbcccbcbbcabaabaacbccacbccaabbabaacaccacccccaabcbbbaabacbbaabbbcacbbabcabcacbacbcabccacbccbcbaaabacbccbcbbacaaacbbcbcbbcaacaabccbabbbbccaccbcaababbbccacabbbcbcabcbaaccabcaccbcaabcbbcbcbacbbacbcbbcaacbcccbccccabbacbcacacaaababbbcbccacbccccbcbaaaacacbbccaabaccaaacabcabccbabaccbacabcbcbbbcbbbcacababbabbcbacbaaaaabbcbcabcaacabcacacbcbcaacacbbabccabcbbbcbcbccbccbabccaacaaccabbbbacbbccbbbbacbaccbcbbabbacbbbcacacbbacabccaccbcaabcbcbbacbcbbcacbbcabbcacccacbacacbabbcccabaaccaabbaacabcbabcbbbaaaabbaaaccccacaaabacacccccaaacabbccbcaacaabbcccbccaacaabaaaabaabaababaccaccbcabaccbacccbcacbcacbbcbbbbaacabbbbabcaccccabccabcbabaacbacacbcabaaccacaaabcbcccbbbbacaccabbbabbacbabacbccbcbbabccabbaabacbaacccbababccbabaabcaaccaaabbabbcbaabbbcbcaaaaccbccabbcccabbbcbaaaaaaacbcabbaacccbaacbacaaccabbbccbcacacaacaaaccbbbbccabaacbabacaccababcbcabbccabcbcbaabbbcbbcacaaaabacaaccbaccbabcbccbabaacccccbaabcbcabaaaabababbacaacabcaccbbbcaacbbacbbababaaccacbbcbaccccacabbcbcccabcccbcbbabaccbcabaaabababbcccbacabccbabcacaaacaaacbaccbcbccaaaacacabbbcbbaacbcacabcabbabcacbaacccbcaccbbacabcccbbacbacaccccbcbcbaabbaccccbabbababccbccabacabcbaaabaaabcabbbaacaaabcaacaabbbcbcacccccccbaacababcbcbbbbbabccbbcabbaaabaccbacbaaacacabacbabbaabbabccabbabbbaabcabbabcbacbccaabcbabcbbcabcbabaaaaacabaccaacccabcbacacbbababcaacacacbabbaaaaccbccaccaaacbccbcabaacabaaccbacacabcccacbaccacbacbcccabbaabcbbbcbabaccbcacbccbbbacbcccababaaacaacbccccbcbbaccbabcabccabbbbccaaaccbababcccbbcabccbccbbcbbbcbcaacccccbbabacbacacaabacbcccbccbaabbcaccababccbbbaacbbcacabaccabacacbacbcccbcaabaabbaaabcbcbcabcbbcbbbccbccacaccccccccbacbacacbabacacabccbabbaccbcabbbcccbcaacacacbacabcaabcccabccbcbabcbcbcaccbacaaaabcabbbbbcabcbbaaacccbabbacbccccbcbbcbabbccacccbbcbccbaaaccbcaccccccccbabcccccccbabbabcccccccaaabcccabbcaaaaabbcbbabbcabbacacaaacbaaaccaaababcbbcacbbcbacaccccbbaccbcbcbabbbababbbbcccacaabaacaabbbcccaacaaabcacbbcacacbbccaaacaaababcaaacbccbbbbbbcbaabbbcabcccbabcaacbcacabcaacbacacaaabccccacacaaabcacaccacbbbcbaaccbbcacbcaaaccacbbbbabaabccbccbaaccabababcacbaaaaccccabaabccccbaaccbccbabbaccbbbaacacabbbacbacbbbcbacbbbbaabbbacccccbabaabcbccabaaabaacaacbbbbccaccbaabccabcbbbbabbccacabaccbaccbccacbaccbccccacaaacacbabacbcccbccababccaabcbabbccaccbccbacacaaccaccabcbaabcabbcbbbbbcaccacabbbaacbcabbcbbaccbabbbccaaabccbbccbaabbaccabcbabbcabbaccacaaacbabcbaacbaaccacabacbcccccbabaaaccbccbbcaaabaccccbacbbacabbcbcbcabbabbacbbbbabcabcabcccbabbabcbabbccbaabbabacaabaccacbcabaaaaaacbbbbacbbaccaacaaabbbacaaaaabbcbcbcbabbccccacbbabbabcbbabbabaacccbbabbbabbbccbabacabcabbaacbbabcccccacbabababaaccabbbbccbabbaaacbbbbacbbcccbabcaaccbccaaababbaaaacabbbbcabababbccbbcacbbaccaabbabaaacbbccbaaabaacbbaabccacbccbbbabcbccaccbbacacbabcaccccaabbcbcababcabaacbaaabcabacabacacaccbacbcaccbaacabcacacbacacaccccbbabcacabbbbaccbbccccbbaabbbaccbacccbaaccacacccacbccbcbcbcabccacacaacacaaccbabbccbacbacacabababcaaccbccbaacabacbcacabccccaaccbcaacaabcbccaacbbabacbacccaacacbcacbabcbbcbcbabbcaaacbbcbacabcaabbcbcbbcbacbbcbabbaaacbabbbccbbbbbbabccabbbcabbbbbcaccbacbcbaccaccabbbcacbacbcbbabbbbabbbccbcaccbcbbcccaaaccbabaaaccaabcbccaababaccacbabcabbcbacbabbcccbbacaccacacaaacaaaccbccbaaaccaacabbbcbbccccbaaaccbbccbcccbbcaccacccacaacababacbcbacacacbaaaccacbcaaaaacaaaababbbaaaccbbbaaaaacacbcaacacabaaabbbbbaacababbcccccbbbacabacbcabbbabcabcaccabacbaaabaccacaccbbaccbacacbccbcbcbabbbacababacabbbcbaccccbababcabccaacacbbcabbbacbccaccbbccabbaccaabbaaabaabacbaccbbbcbcbaacbcbcbcbcbccbccacbaacbabaabcabbcacccbccbacbbbbcaacbabababbaabbbcbbabbbbcbbbbacbcccabaaabacbaabacbccaaacacccbaccbbbaababbabccacbababbbcbacacbbaababccabccbcbbbacbbcbaabbcbbcabcaacccbcacaabbaaaccccbccbaacbababbcacbbacaccabbcaabababbccbabacaccbcaaccacaaacababbbababbacbbaccbbacabbaaccabacbbccbbaabaccabcbacbbbcaabbcacabcbbbabaacacaaaaaaccabbbbccccbabcabbaabacbabcabaaacaabccaabbcacaacabacabaabaabcbccaabcaacbbccbbacbabcccbaccacaccccaaccaaabcababbacccbcbcbcbbbaacbacabbcccaabcabbcabbcbbcbacbbbcabcaacaacaaccbbabcccbacbbbbcaabcaccababacaaababbbabaabcaaabbcaacaacaabcaacbabbbacbaacccabbcaaccbabcbbabbabbbabaaacaabccabbabaacbcaccbcbaacccbcacabbabcbaccacccaccaacccaabccccccbbbbbaabbbcacabcbaabcbabacbbbcbcaaacacbbbbcacbbaaaccbccbbbbbbabccabbabaacaaccbcccacaacababbbacabbaccccbacccbcccccabaaccabbbaaaccbbbbaccababcbcaabcabacbbaccbacaabacbaccbacccacabacabbbccaacbaabcabbcbbcccbbbbcbbcbaaacbabaabcbccbaccbabbbcacbcacbaaccaaabccbaabcbbabcbbabcccacabbcbcabcbbcbcccbabbabbabccabaabbcabaabaacbccaabbcabaaccaccccacbabccbbbacabcccacbbbabcbbcacabacbcababcaabacabbccacabbaabacbbbbccacccabaacaacacccbbbabaacccabaacbcabcaaaaccacccccabaabcbaabaabacacbbbacbbbabbaababcaccccbccaabbcbacbcbcababaccaaaabaabaaccccaccabbbbbccbcbbbacacccbabccabbaacccabccccabacbcabacbcbabbbcbcbbcccbccabcccccccacaacbbcbccbaabcacbcbcacccbcccbcaabbccbacababcbaabbbbaacbacacacbccbaccbabbccbbbbbaaccabcacbabcaaaabcaaacbbaabbcaccabcacbbbccacababbbaabccabaaabacbaacbbaabacabcbaaacbabbaacabccacbbbacccbbcbcacacbaccccabbabbbaacaaaaacbbccabaccbabcbcbcaacbabbccacbbbcbccbabacaacacacbabbcbbbcaaacccaccbccaaacaaaabbaabaaaccccbabcbcccabbabaabbbbcbaabababcbabaabcabcbacacbbccccabacbbcbbaabbabcabbacccbbcbcababbcabcbacabcabbabacbacacaabcccabcbccbabccabbbbabaaccbacccbbbabbbcbbaccccaacabbcaabababbbcacccbcbacbbacabaaabbacaccbabbcabbabcbccbbcacbacabbbcccaaabbacabbbcbabbaaccabaabaacacbbabccccbcabbacccbccbccacababcbacbaccbbbaabaccbacbaccbabcaccbbbbcbbbaaacbbababbbbabbcbbabcccbcababbacaaabaaabcbcbcbbbbbabcaabbcbababacbbaacbcbabbbbcccbbcbaccccbaaaccaabcacbbacbaccccbbcaaaccaacbabbacacbaacacabbccbbaaccbaabccaaaaabcccbbcbcacbcbbbaacbaacaaabccaaaccccccacbaccccbbcbabaaababacbcbcabaabcbcaccbbbaabaccbbbbbbbccbbcccbaacbcbcabbbccacccacaccaabbbbabcaaabaabacccccbabacccabaabbabbccccbcbbaabbcbccbabaaacabcabacbcbbbaaaabccaccacccaaccbacbcbcaabacbcccbbacabbaccbacaaabacaaabbbaccabcbbcacbabbaabcbbcbbcabbbbcbbbcabaaacbcbbcabcabcbabbbbccabbaacccacabacbcacacbbbcaaccbabbcbbcacaaaabbacacbcaaaaabcabaaabccbcbbbccbbbbaabbabaaabbacabbccccbaabccccbbaababccbaabbaaabbbaababacbcaaabcbbbcacaababbabcbcbabaacaccbcccbabaccbbaabaabcbccacbbaaccbcbaaccbaaaccbbbbcbaaacaabcabbacbcccacacbbcababbabccccaccbbbcccabaabbacaaccbbacbabacbcbbccbcabcccababaacabaacaaaabcbabbccbaaccccaaccbcabcbaabcbaacacacaaaabbbcacbaabacccbccbccaaaabacaccaacaccabbabcaccacaabbbabcabbcbbabbabbaaacbaaacabaacabcabcabbabaaaacbbbbbcbaaaaabbbaaaaccacbcabaababcbbbcaabbcbaccaaacccccbbbcaabcbccbbbacabccacbaccaccaacbbccacbbcbcccabcacbabcbcacacbaaabacbababaacbcbcbcaaabaabbbaabbcccbaabaabbaabccbcaccbabaaabbaabccabababcbbaabbbaaccbbabbaaabbabcabaccaccabaaccaccbcacaaabbababbcccbcbacbabacccacbacacacbacacbabbbacccccabcabcbacccaaaaccbabbacaabbbcbcaaabaacaababacbabababcccacacbbbaaaababaaacaabaaacacabcbcabbaaacbcbcbbccbabbaccaaaaccbabbcccabcacbcacbbabcabcbcabbababccaccbcbcacaabbababbbbbaaaabccbccbacbaccaacbbcabaccbbcacabaaacbcacbbbcaacaaccaaaaaaaaccbbcaabaababcaaabcbaccabccacacbacacaccccbaccbacbaaabbaabacaaabbcabcbcacccbbbaaaabcbcbaaaaabaabccaaaaabbbaabcaabbbabccbbbaccbccaccaaacaabbbbbcaacaaccacbabccbacccbacbababcabcbacbccbabcbacccaccbbccbbccababbccbcccbbcccccaccbcbcaaaacbcaacbbacabcaaabbaacbccaabcbaaabcbbaaccaabababaacbbbbabbabbabbcccaccaaabcaaccccccaaabbabaccabcbbacbcbacaacbbcacaaaacbbbccabaaacbcbbccaccaacacaaabcabbbccccabbcbcaabcbcbbbbcbabacaaaabbcbbccbbbaabacbccbcabcabbaabbcacaaaccaabcabbbbbcaabaacaacaccaabbccccbccaacacbcccacbccacacbacbacccbbabcacccbcababccbaacabccbcaaaaacbcaccbabcbbcacabbbbacabcbacbbbaababcccaabbbabbbcacabcbaacabbabcacabbbcbbbaaacbacabbcaabacbbbabbaaaccccbbabacaabcbaaccabbacbcabcaacbacbccaacbbacacaababbaccbbacabbacbbaacbccbcccacabcccbbaabccacabcaabbaacacaccacacbcabbabccaacbacaccaaabbaaccbacccbccccbbbbbcabaacccccccbbabbabbcbaabcbaaaaabccacbbacabcccbcabacbabaccbcaaccabccabccabacccacacbabbbaaacccbccccbcbababababaabcbcbbaabbbbacacbcccbcbabacaabccccabbbcbaccbccabcbcbbaabaacbcabaacaabcccbabccbaaacbababaaaccacaabacaaabbacccaacccacbcabbbbaabcabccbbacbaabbbaccbcbcbbbbcaacbccccbccacbacccabcbbcbbaccaaccaaacacccccabcbbcaccbcccabccbbabbccbbaccaccbbbbbabbbacaacbbacaaabbbccbaaabbaacbccbababbabbbaabaaacaccbbcccacbcbaaaacaabbaabaabcbccbbbacbbccbbaaabbccbbcbaaaaacababbaabcacaabcacbacaaaababccbbbababcabbcbacbcaabccbacaaaabcbaababacaaaccaccbabcbcbcbcababccabccaabcbcccbbabaccaacacaacbcaaacabcbbbabbbaccacbabccbbbacbbaacbacbbbcbccbcabcccacccbcbcaaabaaabbccaccbcabbcabccbccaccacbabaabccccccbbbacacbbbbbabcccbcbabbbccacabcaccccbccccbbcccaabccbccabcacbabbbcbcaaccbbacbabaaaccaaaabbbaacbccccbccabcaaccccacbabbaabcbbbccaacbcacabbcaabbabacabcabcbbbcccbbbcacbccaabcbbccbcccbcbaccbbcbaccccacbccbabbccbbcbcabbcccacbaabbaccbcbacbcbbccaccbcbcbbaacbcabcbcabaccabbbabccacbccaacabcbabcaaaacccbcbbcbbbcabacbcbcbbacbaaaabccabccaabababaccabcbbaaacccccbcbbbabbabcbaabccccaacccbbbbcacbaaccaaacaabbabacababbacccacbaabacccbbacaacbaacccbbabacabcbbcaccbabbabaaaccaabcabbbbbaccbcaaaaaccccbacabaabbcbcbccaacabababbbabcbbacacacbbcbbbaaaaccabcababbbcbaaacccccacacabccaabaaaabbbabbabcaccaaabbacaabbaaccbabacabaccabbaaacaccbacbbbbcabcaabcbbaacbbcacbaacbacbaacbaccabbcccbbcbccacaccbbaabbaaccbcabcbcbabbacabbcabccabcaccabcbcbcccaabcbbcacacccaccbbbaababbacbaccbababcbacccacabcababcaccaaacaababccbbabaccaacacabacbcbccaacbcaacacabaabbacaccbaabccaacbcacabbbaacacccbacaaaccabcaabccacabbbaaacccbcbcccaaabbabacbabccabbcaaabccabccbbcbabbaababcccacacbbabccccaaabaccaccccabbcabcaccabbccacbbccccaccbcacccbbaaaaabbbabbbcacaacacbbcccabbbbbcbbbbaabbcbbccaacaaaacbcbcbcccaaccbbccaaabbbcabbccaacbaaccbaaabcbbaccacaaaabbcbbabbcccbcacabcccaaaabcaabccacbccbbaacaacabbaabcaacbbabccaaabacaccaacacbbcccbbbbbaabacbaabbcabaabaabcaabbbabccbcaccbbbccccbbbbbbaaccabaacbcbbbbaabacacabbbaabccaaaaccccababccaabccbabacabbaccbccbcbacbcccacabbabcaccccccccaaacbbbaabbccacaabaca".to_string();
        assert_eq!(15828, Solution::longest_balanced(s));
    }
}
