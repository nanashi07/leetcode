// 3714. Longest Balanced Substring II
// https://leetcode.com/problems/longest-balanced-substring-ii/

struct Solution;

impl Solution {
    pub fn longest_balanced(s: String) -> i32 {
        let s = s.as_bytes();
        let n = s.len();
        let mut max_len = 0;

        // Use Vec on heap instead of large array on stack
        let mut freq_dist = vec![0i32; n + 1];

        for i in 0..n {
            let mut freq = [0i32; 26];
            let mut unique_chars = 0i32;

            // Reset only the elements we'll use
            let mut max_freq_seen = 0usize;

            for j in i..n {
                let idx = (s[j] - b'a') as usize;

                let old_freq = freq[idx] as usize;
                if old_freq > 0 {
                    freq_dist[old_freq] -= 1;
                } else {
                    unique_chars += 1;
                }

                freq[idx] += 1;
                let new_freq = freq[idx] as usize;
                freq_dist[new_freq] += 1;

                if new_freq > max_freq_seen {
                    max_freq_seen = new_freq;
                }

                if freq_dist[new_freq] == unique_chars {
                    max_len = max_len.max(j - i + 1);
                }
            }

            // Reset freq_dist for next iteration - only reset used elements
            for f in 1..=max_freq_seen {
                freq_dist[f] = 0;
            }
        }

        max_len as i32
    }
}

#[cfg(test)]
mod tests {
    use crate::medium::longest_balanced_substring_ii::Solution;

    #[test]
    fn test_longest_balanced_1() {
        let s = "abbac".to_string();
        assert_eq!(4, Solution::longest_balanced(s));
    }

    #[test]
    fn test_longest_balanced_2() {
        let s = "aabcc".to_string();
        assert_eq!(3, Solution::longest_balanced(s));
    }

    #[test]
    fn test_longest_balanced_3() {
        let s = "aba".to_string();
        assert_eq!(2, Solution::longest_balanced(s));
    }

    #[test]
    fn test_longest_balanced_4() {
        let s = "abcbaacbcaacbababcbacacaabcccbabccabccaaabcbacccbbbaaabaacaabcbbaaababcacaabcaaacbbcaccbaccbacacaacccbaabbcacbcbccbacaabcbaaccacabbcaaabacacbababcccabbacaccbbbaaababbccccbaaaccaaabccbbbbcaacbcbccabbaaacbbbaacacabacaababcbbacabbbcccccbaabccbaacbbcbaabbcaacccccccbccacacbbaaabaaacabccbacbaccbcccaacccbacbcbbabbaaccbabbabbbacbbabbacabcbccaaaccbababccaaaaaabcbcbabbcbabcaaccabbbbbaabcabbacaabbabbbbccbbabbbccacbbccbaabbccaacaaabcaccacbaacaaaccbaaacbacbaccabbcbacbacabaabbcabbcaabbaaacababcabcabacccabacccbacbacacbbbaabababbcbcabaccbcaaccaaccbbacaaaccbaaccabbcbbaacabbcccaccccbcbacaccacccbaccbcbbbabcbcacccacaacacbbaabbbcaacbbccacacabaaaaaabcabaaacaccccccbbcccbbcaacbacabcbcbcacbaaababcacbacbacaabbaababbbbabbbbacbaccbacabbcaaacbcabbbbaaaaabbbbbbabcccaaabababaabcbcaabcbaacbcccbbcccccbcbacbaaccababbabbcbbcbbccbccbcbbbaaaacbbaabcbacababaaccbcbabacbabcccaccabacbcccbcaacbbcabcbcacbaaaaaccbcbbbbbabccaababcbbcacaacbaacbcabaaacccbbbaaabccbcaaccaccacbacccacabbccccbaaccbcaaacacaacaabbcccccabcbcabbcbcbcaaaaaaacbababcccabbabbaabccbacbbbbabbcabaccbbaabacccccbbacbbccabbbcabaaaccbacacbccababcbbaaabbbcacacbabcbcbaccacacacbcacacacaacbabacbccbccccacbcbacbbbcccccbacbbcbbccaabaacbaaacbbacaccacaabccaaaccbbaababcabaabbbabcacbacbbbcabbabacaccccaaaabcaacaaccbcaaabaccaabaccacaccccbcccaccccbcabbabbbacbababacabcabacabbbbbcbacacaabbaaccacbcaaccabababbcbcbacbbbaabccbaaccccacaababccccbcabcbbababcbbbcaabbacacaaacabaabbabbcacabcbacaccabcbbcaacacccbbaccaaccbacbaccabacccbbabccaabacbabbabcacacbaccacbbcabcaabaacaaccacabaccccbbbcbcbccababcaccaaccabcaabbcacaacacaccbacabaacccaacacabccacbbbbcaaacacbcabcbbbacccbbccbcbcbcbaccaccbababaccaacccbaccbcabbbaabbacbcbcacbbaccbccacccabacbabbaabaabcccbaaccbaaacbccaabcaccabbccccaacacbaaaaacabacbcbaaccaaabbbcbacbcaccbccaabbabbcacabbcccbbaaccbbcccccaaacaacbaabacaacacaccbbbccaababbcbacbacaaaccbbaaabaabcbbbbacaaccbcbbaabcacbcacababbbcccbbaacbcccaccababcabbccabacbcbcabcbacbacabbcaaaabbaaacacbaaaccaabaaacacbaccbbaabcbaababccbcbaaaacbabbbcccbcabaaccaabbaaaacbabacaacccbccacaaacbcbacbbbcabcccbcbcbccbbacccabaaaaacaacbbabaacaccccabaaaabccbcbcabbccabcbacbbacccabbacaacbaaacabbccacbbcaaacbcbabccacbabbcabcbaabbbabcaacbbbbcabbcaaaabaabbcbcbbbcbacaacccbbaacaccaaacbbccacaccabacbcbbbaacaabbbbacaccccbcbbccabaacccaaccccbcbcaacabbaaccababcbaabcbbbccaaaaccaabbbacbaacbacbaabaaababbcabccbccabbccbbcabbccbbcabbbaaaaccacccaabbbaacbcaacbcbcacbcaaabacbccaccccccaaacaccccbaccbaaccccaacbccccacccbacbbacbbcccaacaabbaaccabbaaacccabcbccbbbaccbcabccabcbbabaacabbccabcaabaacbaabacaaaccccbcbcbbccbbaacacccaccbaaabaaabbbbcbaaacacbcaabccbcabbaaaaaccbbcbbaabccaaaacbbbcbbccacbbacabaaaabaabbccbbccaabbaaacccababaabbcccbcbabbaabccacaacaccbabbaabaaaaccacbabcbcacbbcacabbbccbacbcaaabaacacacccbabababacabbaccbacabbaaccaabbcababcbbcaacbbcccbabbabbacbbaaaaacbcbbcaaccbbbaacbbcabacaabcbcaccacbbcacbccacabcbcaccabacbccbabaabcccabbcaabcabaacccbcbacbcccbcabbcaccbbbaaaccaaacacbbbcccbbbccbaabcaacacbccccacababbaabcbcaaabcbabcabcccbacbacacaccacaabbccaacacbccacacabcbbacbabbaaabacbccbcccbbacbcbbbbcacacacbccbbbbbbabbbcbbbcbcbbaacaabbccaaccccbabbcaabacaccbcbaaccabacaaccbcbaacaacbaacababcbcbaccabbaacbaaabcacabaaaabbbaaaabcbccacacaaaacccbbbcbcbbaaacccbbcbacaacbccaaaabcbcacccabbaabacaabbacababcaabbbaaaabcccaaabaacccbcabbbcccbcabbaccabaccccbabcbbcbaccacaabacaaccbbbbabacbccbbbaccababacaaacaabbbaaaaabbbbbaccbbacabaababcbcabcccbcacccbaacacacbcacababbabacabcabbbacbccbcccccacbcbcccbacaabbccaabbcbcaaacbbaacabbccbbbaaabaaabcaaacbaaabbcbbbccbbbaabbcaacbabcacbbcabcbcaaaabbbcbbabacbcbacccbccaaabaaaacbbccbababcbbaabaaacaacbbcbbcacabbaccacaaaaacabbbcacaaabbbbcabbcbcacbabaacbccaacaaaabbabbbaacbcbbcaabaccaaaaabaabbcbcaccbbacabaaccbbcbbbcbcababaacbabbcbbbbabbababbccbbbbabbabbcbcabbbcababaababcacbbbbcbcbbbbccccabcbcabcbcacbcabaaccbbabcacaaaacbabbcbabacbbbbcbababccbbabbccbcbacaccacacbcccbbabbbbccacbaabbaaaaaacacbbabcaccbaacacabbaccbaccbcccbabacbabcbcbabbcabaccacaaabbaccbabbcabcabacaabbcacacaacbbaccaccccbacbaaabbccbabccccabbacccaabbaaabaacbbbabababbaaaacccabbbaababbcacbcbcacccaacabbcabbbcaccbcabcbcaaacaaabbccabaaccacccaaaaaabcbaababaabbaaaaccaaabcbbaaaaacbcaabcabacbbbcbbcabbaccababccababaaacccacccaabbcabccccacbbbccaacbaabacacabcaabbcacbcabbbacbccabbaaabccabaabaccccabbacacbccabaaacbcbcaaabcababbacccccbccbaabacbaaaacbaabaccaaacacbabaaaacabaaabccacabaabacbcbbcccabbcacbcabcccaabbabbacbaccababcbabacabaabcaaaccabcbcabbabccbaabbbabcbabcbaabcacabaccabccacacaccbacbcacbbcbbcbcaabbabccabaaababcacabbbccbabbbbbccbabaacaaacaccccbbaccaacacccbabacbbaabccbbcbcbacbbccbaccbacaabaabcabcaccaaaaaabccbaabcbacaccabcbacaccbbbcbababcacbabbcacababcbaabcbcabaaacbacabcbbccccbcbbbbacbbbcbaabbbaabcaccabcbccabaccabcaaaaacacbacacbaacaabbcabccbabbbcccacccccaaaaabcbbbbbcaacbbcabcaacbaccaabbbaabbaabbabbcacabaaaacbbcbbbbcabbcabcbaabccbacccaccbacbcbaabbbaacbacabbaaabbccbcbabbacbaabccaaaccccccacaacbbaaacccccccbcbbbbacbacbcaccbcbabaccbcaaccaaccbccabbccabbcaccccaaaaaacaccbbaacbcccacacacbcbacbcbbbbccabcbabbbabacbbcaaaacabbcbbcbcbacaabcccaaccccaacaabbcaabcccbbaccaaaabcabaacbcabbcbbacbccaaabaaccccccbbabbabacbbaccacbcaabaacbccacbbccabcaacbbacbbccbaacbcacabaaaacbccccbaacababaccccacacbcbabcaacbaaacbcbcbcccbbacbaaacbaccbbbcacbaaacaabacbabcacbabcbccbaaababbbbacbbbaaaaabbcbbaacbacaabccacaabbbbaaccbabaacaaacbcccacbcbcabcccacaabacaaabaacbbbbaccaababccbaccaccababaabcaabbbcaabcbbbbaacacbbaacbcacabbaccaabcabccbaacbaacbcccbbacbbaaacabbbccaacbaacbbbbaabbcbcbbabbbabbaccaccabbacaabccaabccabaababbacccbcbaabbcbacccbccbabbbabcbcbcbaaabccacabacaaccbcabbcaabaccbcabccbababbbacbbaccbccabcbaabcbbcbbabacccbacbcabccbbcbacaaabaccccaaacbccaacabbbaaccccbcbacbccabbbaacacaccabccaacbabbbcbbabcbcbbaabbcbbbcbbcbbcbbaccbcabbabbcbcacaaccacabcbccccccbbccbbbcaaccaccaccaaaabbcbcbcbbaaababcccabcacabbcbabcccbabcabaaacaabbaacaaaaacabccbbcbbcaacbbaaacabbbccbbcbbccccaacaaacbbccacabbccacbccccabcbbacbacbcbaabaababbabbcaacbacaaabcbbbabbcbbccabbcabababbcbababababbacbcccbccacaccabbbccbccbaaaaccbbcbbabbacabcaccbbcaaccabaabacbabcabbbbcbccacaabbcacabccaaabcababbcabcbaacabaabbbaaaaaabbaacbcaaacccacbbbabcabcbabcbcbacabaacabbbaabbabbbabacaccbabbbabaaccacbcccbcaaaccbaaabacaccbbbcbabcccbbbcaabbbacbcabacbababcbbbabaabbccbabcabacbabaaabbccbabcbaccaacacacabaabaaaaabacacbacbcaaacaaababaaaacacbbcccaabccaccacabbbacbacbcaabaaaccbaacaabababcccacacaaacaabbccacaaabbaccbcaabbabcccabbacccbbcabaaaacaaacbcaaccccbccccbcbacabbabbbaacaccbcbabbbcbccbaaabcbacbbbbccccbccbaaaaabcaccabccabaaacaccabcabbabccabbbacaccabcabcaabbaaaaabcbbcaacccaabacbcacbbbcbcbccababaababcabbbbaaaacbabccccbcbbabaabbbacacbbbcabcbacbbbcabaccaaaaaccccacaacccaaacbaaabbaccbcacbcbcccccbccbcaccbacccbbbaaaaacccaabcbbaaaacbcacaacbaaacabcbaaaccbccbabaabcbcbbacbbabbccabcaccbbacbcbbbcaacbccbcabaaabcaaccbcbbbaccabcbcaccbbbabcccaaccbaccbbcaaabbcabcbbbbacccaaababccbaaccaaccabbcbacbaccaccbabbccaabbabcbabcbbbaabbbaccccaaabbcbacbcabcacaaabcbcacabacacaaacbabcccbacccabaabbcbacccacbcabcaccabbaabacbacccbaccbbcacbababbcbbbbbbbbbcabbaaabbcbcccacbbcbaabbacacababacbbbabbcabaaacaccbaabacccabaaccbabbbbcbcaccbabbbaabccacbcbcaccabccabbbaabbbbcaccbccbaaccababbcacacaccbccacbbbabbaacacbabccacbbbacbbcacbbabccbaccbaccabccbccacccbabccbccaaccbbbabcbbbaccbccbbcbcbaabbabbcabbbbaacbacbacaaabaacaabbbbabbaccaccbccbabbccbcbbcbbccababacacaaccbacaaccaaaabccccacbbbbcbbbaaaaaacbcccaccbabababaccabaaacbbcccabbcacbabcaaaccacacbaaabccabaccacbccacbabaccababbacbabbacccbcccaccbbcabaacbcbaaabaacbcabbabbabaabccbbabcbacbbcaacbbcbbacabaaacccacabbbccaaacccaacacccabccacbbbabaabbbcbbccbbbabbbbcbbcbacababacbcaaccacbacabccccbbbacbcabcacbabcababbbbcbabbcacccaabcbcccbbbaacccccacbaabcacccaccbacacbacbaabbcaccacabcbcccbbcbbacaaccabccbbcacacabccbbccbcccccabbcaacccbccbcabaacacacbcbabbacabccbcaaaccbccbaaaabbbbbabccbbabbbcbbccbcbbcbcababbbabaabaaabbaaccbaccaaabccbbccccaacaabbbaacaacaaaaaababbabcccbacccbcabcacccbbabaacbcacbaabbbcbaaccbbbbbbbacabcababbaababbbaccbbcacbbbacbcaccacabbacaaacccaabaababbbcaacaaaabbaabbabccbcbcbacccaacbbbbbaaabacbaacabbacbbaaaabacabcccbbcbbaaaaccccaaacababbcacbbaaaaaabacacabcaabbbccbccbbaaacbcbbcaccbcaaaaabbcbabaaabbcababbbcccbabcacaabbcbaaabaabbbcaacbcbbccbcbacabbcbabaabcaabcbccccaabbaaabaabbccbbcabaccbcccbacccbccccabcaaaaacbaababcabbabacaacabaaacbcccccacccacbabacbbabbcabbacbcacbbbcbbabcbaccccbcbbbccabcccacaccbbbbbbcabaaaacbabcabaccccacbbabcccaabccacaccaccacaacccaccaaacaaabbccbacccbcbcccaababccbacbabacacbabbbabcaabbcaaacbaaabbbcacbabccbaaaabcbacabaacbbbcaacaabbabcabbcabbccccccbbacaaacacbabbbaaaaccccbaacababbcbbcacabcaaabbcbaacaccbcbbbbcaccbbcbbcbbbcbccbacabcacbaccbaacabacaccbbaabbbaacabbcbccbbaacccaaabcbcaacbcaccbaaababbcaaacacccaaacaccaccaaaccabcbbbabbabacabcabbbaaccbabbcabbbbcbbbbbabaaccaabbabbcbcababbbbabcbabaccaaaccccaacbcbaacabcaabbcbbaaccacccbbcaccbacbccbcacabcbcacaaabccabcaaaacccbbbbaacbaaacbbaccccbbccaaaacccabccaccacbbbacbcbcbbbcbbacccaaababccaacbccbbcccccbbcbaacabccbcbcbcbabcbbbbacacacbcbabbbacccbcbcaabacbabcccabaacacbbcabbbabaacbbaabaccbbbacbbbcbccbcbbcbcacbcbbccbaaaacaccbccaacabcabbcbbabbabacbcaccbacacbaaacbcbcaacbbbcaccaaccbbcccccbabbabbaabbacbbabcabacbabcaaacccbbbabcabccbcbacbaaabacbbbcbababcbcabcbcbbbcbbcccccabcaaacbabbbaacbbacaacccbacabbbbacaaaaababcabbcbbbcbbbcaabcccccaababcaaccaaacbbbbbccaaababbccccacbccaabbaabbcabcccbbbbababacabbbbccccaacbcaccaaccbbabbcbbbbcaaacbcaccacacabccabbacbbbbababaacaccbcaccbbcbaacbccbaabbcbccababcabaaaacaacbccacbcabbcabcacaaaccabbbbbabcbcacccababaaaabccbcbbbbbaabcaccabaabcbccabaaaaccbbacaaacbbbbbcacbbbbabaabababbbaacbbbbabcaccbcacacabbbabaabaabcbaabcccbabbbcbbacccbabbbbbccbabcabcabacbbaccccbccaabaacacbabbaccccababcaaacbbbbbabbbaabbcbbcbbaacabaccbbbaacbabbbcaabcacabacbaabcabbbbcabbbabbcacbacbcaccabbcbacbbbcbcabccabbcaccaaaaabbaccbabbcacbbbcbbbbaccbbbbbcabaccbcbcccababaaaaccbaabbbaacabaacbbbbacabbcacaaaababccaccbcababbcaaccbcbbcaccabcacbababbabccaaacbababbcbbcbabacbababaacbcaaccccacbcacbbababaabbbbaaacbabcbbaabbbcaaaccaccbbccbbbabbcbccabaabbcbcbbaaabbabaaabcccccababaabcabccbbccabbabcaaaaaaabcccbbaaccbbaaabacccabaacbbabbabbaacaabcbbbabccbcabaaaaaaaccbcbccbbccccbbaaabacaaccccacaacacaaabbbaacccaacacabaacabaaacccbacbaabacbccaacababaaabbabbbbaccaabaccabacaccccbabaaaabbcbcabbbacbcaccbccccbcabcacaaaacbccbbaabcabababbbabcaabcacaaaabbbaabbcababbbcbcacccacaccbbabccbbabbccbbcbabcaaacbbbacacabacbbaaaccaaccacbbccacbacaacbacaababbcabcbbabacccbbaabaccaaacbccabbbcccbacbbaccbcabaccaacbabbcbbcbaaccbccbcabbbaaaabcacaababaacacabbbbbcababaaacbaccbbccaaccbbacbbcccbcbabaabaaacacacbccccbbabaababaaaccaaccabcbbccaacbbbbbbbcccbbbcbaaacacaccbbbcacccabaccaaacabacaaabcbbbabcbacccbcbcccbaaaaaacbaccbaccaacbbabccabbcaabacababbababbccbacbcaababbaaabbcbcabccaacabcbbcbcaccccaaabcccccbccabcacccabbabbbcaaabccaaaacaacacabcacababcbaaccccabbccbcaaabacbbaabbccbcbabaabaaaacbaccccaabcbaccacccccbbabcbcbaccbabcbbaaacccccccacbbbbababbaaacababaabbaabbbcaaabcbcbaccccbaacacbbcaabcacbabbbccaacbbacaacbccacbccccabaaaaacbacbacabbaaaaacbbabaaacbbbbcabbbbbabacacaacccacbcabcaaabcaababcabccabcbcaaaaccabcbbbbbaccabbcbaacbcacbbabbbccacaaccbbacaaacabaccbccaaaacacbabcacaabaaaacaacacccccbabbcbccaaabcacabbabbbaccacbcbbbbbccacaaccbbabccacabacccaacccbacbcaababcbaaababbbcabaccccacbcaabbcccababcbacbaaaccbbcbcbaaccbcaabbabcababcbbbbacabbbabcbcacbcbbcaaabbbccbcabbcbbbaabaabccbacbaaccaaaacbabacabcbbacbcbaacababaacbbcbaababaabccbcbcabbbbabaabccbaabaaababcbbcaaaabbcbabbccbaaaccaaccbacaaaacccbbacbbacccbabccbacaaaacabaccccbbcacbcccbccacbababcbbbbbcbaacaacabbcccaaaaacabbbcaaccbbbcaaacacbbababccaccbcbacccbbbccacbbcabbaaaacabbbcbcbabccbaccccbaaaccccbbacabbbababbabcacbcaccbaaababbaabcacbbcacbabccbcbacbcaaaaaabaabababcbacabcabcbbcbccbccacbaabcaacacbbcabcacbbaaaabaacbbcaccaacbcabccacabcbcabaaaaccabccccbcaccbcabaaaabcabbbbccbabaacbcaabacacaccbaacaaaccaacaacbbaabcccaabbacbbcbccacbabbaabbbabbccccbaababccacbbacaaacaaacbaaccabbaaccbcabcababccbbaaacaccbbaccbccbbcabbaabacacbbccabbabacbabaccaacccaaacacbbcbabcbbcabaaabaabbbcacacacbbbabbaccbaacaababbabbbbcbccccaacbaababbcaaacaaacaccabbbaabababccbcbbbbaabbbbcabbcbbcaacaabcacbacaabbabcccccbabccbcaacacbaccaaacaccabbcacbbabaaaaaabbacbcbccbcbcbbcbbbbabbabcbbbaccbabcabbbcbcaaababacabcbccbacbaaabbcccacaaaabaabaaccccbcacaccacbcaccabaaaabcbcccacabbcccccaacbbaacbcabcaaacbbaaacacabcabaaabccbabacccccbabacbbcbccccccbaccaacacabaaabccaaaacaabaababbcbcacbccccbcbbabbcbcaccaccaaaabaacbbabbcaccabcbacaccaaaccbaaaabccbabcababbcbabbcbbbcccccabccccbacaaaaabcaccabccbaabaabccbbaabcaabbbcbcbbababbcbaabcbcbbacbcacacccacbcbacabacababbabcbcbcbcaccaaccbcaabacbaaaabbcbbbabbabaacacccabbbaaaabbcabacaccbabbaccccaabaccbbabbbcbcabbcbcbcaccaaabaacacaccbcbccacccaccaacbbbbbabcabbcaacbaabbbcbacbcccacaaabbbbcbbbbccbbaaaccbabbaaaaccabaacbcaccbaaaaacacccabbbcbaacbabaabcaaaaccbbbabbabbacbabaccccbcaccbaacbbaacbbccabcbabbcccaaacacacbabbccabbabacbbcbabcbaacbbcaaabcacccccbabaaccccbbabaacaaaaaacbbbaabaaaabaaababaaaabbacaaccaccabbaccaccbcacbcbbbbbacaaccccbabccccaabaccbaccbaabaabababccbcaabaaaacaabbcabbbbccbcccbaacaabcbccbabcaabbcbaabaacbccabacacaccabbacacbcbbccabbcbbbcbbccbabcbbcbbbbcaaaaccbccbccabbabccbbaacbcaabcacacccbbabbbcacbbaabcbcccaccaaaababcbabcbcbacacaaabbaaccccabbababaacbcaabcccbabbbcbabacccbbaccbccabacacbccacbccaccbcbbcaaaacababaccabbbaccbbcaacbabcbbbccaccababbacabcbbaabcbcaccbbbbcbbaaabcaabbaabcacacabaababccaccaabbcaababbabccacabacacbbbbbccacccabcaabbbbabaabcacabbbacababbcaaccaaccbcabbbcbcbbbaacacbabbcccacabbbacccabbacaabacbbababbaaabbbabacabcababacabaabbbcaaccccacacabacaaaacbbaaabccbbabacacbbbcaacaababbcbcacaccbbcbabbcbcaacbbcaccbcabaacabbbbabbbbcbcacbcabcabacbabcacaaacbcbacbcaaacacccaccaacaabaaacabcbacaacccbbbbbabcababbbbbabcaaaabababacccbacaabccaaacbabaacabaaabcabcababbabbaacbbbcaccccaccaaabaabababcccaaaccabbbcbcabaaacacbbbabcbbcbcacaaaacbbcbbaacccabacaacccbcaabcaaabcbcacabbccbccccccbccaacabcaccbcbaabbbbcccbcbcbabbaacaaaabccccbaccbbbabcccaaccbacbcbcccabacbabcbbccbbcabaacacbcaccacbababcaaccabacaccaabcbacbbcabcabbbcabaaacbbbccbcccbcaaaacbaccabbbaaacbaaabbbcbcccaaabacccbbabbbaccacaabbcacbabcabcacaaccbaacbcbabcaabaaaccccacbbaacaacaacabcbbaabbbbcbaaabaaaccbbcaacaacbaacaabacbbbcbaaacccbbbabcccaababaaacabaaabcbabcababbcabcaccbbabcacacbbacbaaabacabcbcaccabcacbcbabbabaaaabcaccacbcccbacbabacacccbcacacaaaabbcccaaaacabcacbabbabcccbaacaccbbaaabacbabababaaacabbaabaabbbcbcaccccabbcacbcbaaaacbbabbacacaacbaacccbacacccbababacbcacacaaacbabccaabbaccbcccbaccacaaacacbcccbabbaacbbcacaacbcbbcbbbaabccbbbcbcababbbbaacaacabcbbcabbcbcbbbbcacabbaacbaccaacccbbaaaacaaacaabaaabcbaabcbcccbcaccbbbcbacbaccaccacbabaacbabbbbaabbcbacabacbaaabbaabaacabcacbacaabbcbbcbaaacacbcccaccbbcbaaaababbccbcababcabcbbabbcbaccbbbabbacaacbccbcbcabbcbabcaaaccbaabcbcababbcbaaaabbcacbbbcbccbcacaccaabbbbcbbbaacabbccabaabcaccbabacabacbabbbbacaabacabaabcbaabbbbaacbaaccbabbbaccbbacaaccbcbccbbcbbacaabaaaccabacbbbccbbccabaacbabacaababcabaccbcaaccbcaabababcacbcbacabbabbbabcaacacbaaccbcbcbcaabbaccbababcabacbababbbbbcbcccabbaaaabbacaaababbabcabcbcbcbacacccbbcaaacaaababbbacbcbaabbbcbabbacabacacaabbbcbabbbaaabaaabaaabababbababcbabcacaabccacbcaaacacabaaabcccbabbabbbcbaacbcacccacccbbaabbcbccbccaaaabcbacacbbaaccbaabbbcaacccccbbcabccaaabacabbcaabacbcabbbabcbbaabbacccacaacbbabacaababbbbbabbccbcacbbccaabbbacbbaaaabcbcbacbacbaccbcaccbbaaaacbababaccacccaaacaababbccabcaaaccbcabbccabbbbabccbbcbbaccbccbcaaababcbcabcacabcbccccbabacccabbcbcbbcabbbbbcbaccaaaaaaabaacacbcbcaccbccbcbabcbacacbaaaaabbccabbcccccacbcbbaaccabcccaccabaabbacbbbcbcaaaaccbacaccbaabbacccaabcbbbabbbaaccacaaaaabbcabaababbbccaaacaabcaaabcccabcbbacbbbcbbbcabbbcaaccbbbcbaccabcabccaaacaacbbbaccabbcccaacbacaacbbcabcaccabcccbcaaccaabccabbcaaabbabbaacaccbabababcbcbccbbabbacbbbcbbcbaacaacaaacccaaaaacbbabcabbcccbbbcabccbaccbbccccabaabbbabbcaaabbcbaacccccacbbbaaabaabcabcccbaaabbbbbbbabaaabcacccacaccbcbcccaccbacbbcbacccacbabbbaccccababcbcbcaaccabcbcbccbbbaaccaccaabcacbaccabcbbbaabcaacabcacbacbcbaaabcaccccbbabaabaccabbcacccacbcacaccababcaabcccbcabccabaccccababbcbcababaabcbbaabccbaccbbbaabaacacacacabbccbaccaccbbbcbcbcbbabbaaacbbaacbaaaaccbbacabaabaabbcaccbccabcacacccaacacbabaaabaccbcacbaabccbbbcbaabaaabbbacbcccabcbbcbacbbacbbccccbaaaacbbbaabbccabcbaccbccacbbabaccbaaacababbcaabbbbabaabbcaaaacbaaccbaccbbbccabcacaccbaabcbcbbaabaaccabbaaabcabbbaabbbbabcbabaaacacacaaaaabbbaccccccbaabccbbcacbcbbbbccbbabcabbbcabbbbcbbccaabcccbcccababbaabbaaacbbbaabbabcbabaccabbccccbacbacabccbacaabcbabbacabbbaabcbccbcbbbcabccbabbbccabcacccaccabbccbabcbbcbaaaacbcccabbaabbbbbbccacbccabbccbcbcaaccbabcbcccabacacbaacaccbcaaabbabccbcaaaabbbacbabbbabcccbbcbaccbcbbbacaccbcbbcabaaabacbacbbbcaacbccbbbbccacacbbaccbbaaccababaaccccbbaaacacbcbbaaabccbcbcbabcbcbbcbbbbcabaabababbcbaacbbbbbacaccaaaaccabacbaabbbbbaaaacbcbbaacbcccbacbaabcabcbabaaabcbcacacacccabccbccbabaabbacabcbaabcccbbcbbcacbccbacacbcababccbcacccaacababcacabcaccacabbcccbabcaabacaaaccccbbbacacbccbbbcccabbcbbaacbcabccccccaabcbbbacbacacacbcccbbcacbcbabaccaccacaabbaccabbbaccbbcabbacbbaccaccbcbabcbaccaabccbcbaaaabbccaacbbababcabbabacaacccbaacaaccaacaccbabcbabaabbababbbacbcabcacbbabaacbabcbabcbbbaacaccacbacbacacabbaaaacbbaccbccccbababaacabccbaccaabbbbccaabbccacbcbbaabcbbacbcabacaabaccaaaccabbababaacabccabcccccbcabbbacccaabbbabcbbcbacaccbacccaccbcbcbbbbccccccbbbcabccbcbbcaacacbcaabcaccccbcccaacaaccaccccbcbbacbcaccbaababaacbbcbababcabbbcaaacacbbcbccbabbccacbccaaaaabcccbbacbabcbcaccacabcacbbabbcbabbaaccccbbcaabbbcbbccabccabbcbbccccbbbcaabbbaccccbcaaccaccaaacbbcbbbaacccabbaacabbbaaccbabcbaaaacbcaababbcaabacbccccabccbaaccbbabaaabccccbaabbbcbcbbccacaaaaaabcbccbcaccccacbaccccacccaccccbbbcaaaaaabacbabcbcbcbbbbabccacbbacaabccabbcbcabaababacaacbccccaacbccabbbbbbbbcabbaaaccbbcbcbabcbcabaccccbcabaabbbbbbbacaaaabcabababcbbaccccabcacacbabbcbccbcccabaaccbccacabcaacccbaccacbaabbaacbcbaccccbabcbccccabbcccbccaccbcaaccbbbbbbbaaaaababccbbbaabbcbcbcaabbcbccacabcabbbcacbaccaaaaaccaabaacacbabcbabccaabccabacbcbcccaccbbacccccbbcabacabacacbcbaccabacbaabcccccccbacbbbcabbccbacabacccbcccbcbabccccaabcbcccbcbaacccbacaaccbbaaabaaabcacaacaabbbcacaabbcaabcbbcaababcbbbbcacacbcaaccccbcbcaaabbcbccaababaccbaabbcbcacbbbbccccbacaababacbbbcaccccabccaccabaabbbacaccbababaccbabbaacbcaaabaaabcabcbbcccaaaaabbbaaaacaaaaacbbbbcbbbacccccaaaacaccbbabaaabccbababaacbabbcbabccbbabbcbcbcbcabcbcaabbcacbaaacaabababaaabbcbbbabcbaaaacacbabcacacacbcbbbabbcabbbabaaacbccaabbcacabbccabbabbcabbaacbaacccaabacbaaaccbbbcbaaaccbcbabaacaccbcccaabbbbcabcbcbbcacbaababbbcbacbbabccbbbcccabcabbababbbacacbcaccaabbaaaabcccaccaaccbbccbabacacacbaaacbcacaacbbbccbcbbbbbaacbcbabaacbccacbabbcccbccacbacacccbbbbcbacbbbbcbcbcbbcabcbbbababbbccabaaccccaababbbacccabaababcaacbcabbaacacacacccccbccbcbccabcbcbcccccaacbbbaccacababacbcaccabacccaccbaacbaababbccbbcbcbcbcaacababbbbcbacbbcbaaaaabaabcbbabcabbcccaabacacbccccabaacaaabccbaabcbcbbccaaaabaababcacacabcbbcbaabcbcacacbacbccbbccbcccaccbbbcbaacbbccabcbcbabacccaabccbbacbbccabcabcbbaacbcabccbbccbbcacabcabacbaccbbbcabaccbabacbacccbabacbacaaabcacbccbcbccccaacccbbaacacbccbcbabababaccbbcabcccbbabccacabaacbcbbabaabaacabbacbaacaabcacaacbaacaccabacabcbabbcacababbababcbacabcaaacabaacbbccbcbcabbacaccccacbbbbbabbccaccbbabbbccbcabcbaabacacbbabcaabcbacacbacaaabcbacbacacaacccbcbbbccbccbcabcabccbacbbacacabcaabbcaccbbcabaacbcacbcaacbabacaaccbacbacbbaaaabababaababbbaccabbbacacbabacabbbacbaaabccbcbcabacaaacbcaaabbaabcbcbaabcabccacaaaacaaaccbcbacaaabcaccaabacbcbcbbbccbbbaaaaacaccaccacaccabacbaacaaabccbcbcbbacabaacbacbcacaacabaaabacbacbccabccbbccbaabababbacacaccabbbccbbaaabccbcaabaaaabcbbcbcaaaccbcabbbcabcabbbacaaccaacbbcbbacbcbaaccccbabbbbcbbcaaccacabbbcacbbacacacccabcabcaababccaaacbccbabaccbcabbcbcaabacacbaaaacabaacabacaabacbacaccacccbaaabcbabcaccaabcacacbccabaabbabcbbbcabcabccccbcbbacccaacabaccbcbababababbacbccbacccaabbcbbcacbcbaaaabcbcbacbaccaccbcabbabacbabbcaacaabbcccaccbccbcbbbaccabccbcaabcccacbacaacaacabcbbccbacbaacbbccbaacbabaccbabaacbcbbccacbcbcbbbccaccaabcabbacbaacabaabbabbabababacacaacbaaabbcbacbccabcaabcbcaaccabbabbaacabbbcbaaacccacacaaabbacbbabccacbaccaccabaabccacaccbcabbaacbcbacccabbbabccccbbaaacbbbcbbcaacaabcbbbcbbabacaaabaacbacabacccbcaaabbbaabcaababbaccbcccccaccbacaabbbaccbcabbaccbbbacbbacbbccaccccbabacaaacaccaccbbbccabbbaaccbbaacbabcbcbaabbacacccabbacbbaacaabaacaccbbcabaacacaacbababacccbbabccbbaaaaabbaccbbbbccbaaacacaabbabbaabbccbcabbcacbccaaccaaaaccabcbccabbacaabacbccaaaacbcbcacaaaccaabbaabacacaccaacaabacaabbaababbcbabcbacccaaccaabbbbcbcacccbabcacacbbbbccbbcbbacabacbbaccbbaaccbababccbbbbbbabccaaacbbaacccbbaabbcabaabcbcaaccbacccccbcbcbacbcbacbacbaaabaccbaabbaabbbcbabaccaccccccbcbacbaabbaccbababcccbacbcbbababaabcacccbcabcbbababacacbbcbabbacbbbcbcabccbcabacbbccbabacbacabbabcbbbbcccbcabbacccbaababacacccacbbabaabacbbcababcbbccbacbcaaacbaabbabcaccbacacbaccbbcabccbaacbaccccacbbbccbccaacccbabcbbabbcaacbaacacabcaccbcbbabcabbbacaacabbcabcbabaacbccccbcbacccbabcaccbcbccabbbcacacaacaaaaaaabbcbccaacabbbabcbbaccabbcacbcaccabbbbbbbcabccccbcccbcacaccaccbccbaccbaaabaaaccbacaaccbacbaccbaccbacbbbaaaaaacbcaaaaaaaabbbabaccacbbaaabaaacbbcacbbcbbaccabbaacccbccabbcaabcaacbbaacbcaabbcaabaaacbaacbcabbbbacaacbabaacbabbcbbabcbbccacccbbbabccbcccbabbabbcabccabcbaabaaccacbbbbbbacbccbcabbcaacabaccabcacaaccbaababccbcbbaaabbcbccbabbacaccabbbacbbcbaaccaacccccbaccbbacbbaacccaacbacabcbcbccbacababaaabacbcabcabbbbabbcaacbbbbbccbaabccbaaacabcacaabbaccccccbcbcabbaaabccaabbcacbbccbcbbaccaaaaacbbcbcbacacbabcbabacaccaabbcaaaacbbbabaccaabccbcbccaacbcabccbbaaccabcbbbaaccbcccabaaabbcbbaabacabbcaaaccbcbcabcabaaaaaccbcaabbcbcabcccbbcccababcbcccbacccabababbcaccaccabcacabcbccbacaacaccbbbaccabcbcbbbcbbbcababaacccbacbacabbabcaaabaaaccacbacbaacccabccaabbcababbcabccacbbbbbbbcacaaccabcaabcccabcbcbccccbbcacbbcbacacaabbacbccaaaacccaccbacbaabcbacbccbacccacabccbaaacaaaabababbabbcabcbacabcaaacbcbbaacbbbbabbacababaabcaccaacccbbcbcbbaccaaabcbccabbbcbcacaaacacbabcbacaccaabcbaaacabbbbbacaccbaaabcbbbbbabacbaababbcbccbcaacbcbacbabcaaccbabbccbabbcbcbbcbcbbbcaaccabbbbbcbabaabcabaabbccbbccbaabcbbacaccbbbbaaaaabaaaaabccabbcbbaccbabbababcbbccbaacabbbcccbbcaaacccacaccbbcaabaacbbcaccaabcaaacbbcbaaababbacabccaccabbcbaaaccacbbcaabcbbbacbcabbbbcccbcababacbcaabbcccacbcacbabababbbcabcbcabacbcacbabacabcbbbcbacccabbaccabccaccbabaaaabcbccbcccbcabaaaabaaccccaabbcabacbbcacaccccbcaacbbccaacbabbaaaacbaaabccabcaabccacbbacbaabbcabbabcacccaccccbcaacacaabcbaacccabbbbcaabbbabacabacccccccbbabccbcbabccbaccabbabacbcbabaccccbbcacacbccaaabacbaacbacccacacbabcbabcbbaccbacbbacabaabbbcbbaabcabbcacbbcaabacccbabcbabbabaccabcbcaaaaabbacbccbcacacaaabacaccabbbbbccaacbbcccbabbbbaabaabbaabcabacacbcbacbaabcaccaaaabbbabbbaaaccacacacaabaabbbcbbaaaabbbacccacaaacccbbbbbcbabacacbcbcabaacbbbbcbbaabcabcbaaaccccaaaaccaacbaaabaccbccbbbccabbabbcababcbaacaaccbbccaccaaabcccccbababbbcaaabbbabcccccbaaccbcababbcbbbbbbbabccbaaabcacabbbbbbbbbbcabbcbacbcbccaacbbcccbabcabccabaaccacacabbbaccaacbcaabcbbcbcbaaaabbbbaaccbbaabcccbbccbcabacaaabcbbcbccabbacaacaacbcabaccaacbaccbbbcccacaaaabccacabccabbccabbccccabbccbababacccacccbbaabcacacbbbccbbacbbbaaacccabbabacccbaabccbbcaaacbaabccacaccacbcababcccbccbaabaccacbcacabbaacccbbcabbbcaabbbbaabcaccbbbabbcbabcaabaabbaacbbcabaacccbbbcbbbbbcbbbccbcbcbacacabbbabbbbcaaccaabaacbaababcccaabaaacacccbaacbccbccbcbbbbbbabcbababbcaabbacbabbaababbcbcbbbbcabbcbaababbbcabaaaaabcaabcaaccacaababbcbcccbccaaacabbcabaaaacccccbcbaaacaccccabbaabbbbabcaabababababbcaccabccccbabbabbbabbcbaaabacbbcacbbcbabbcbcaacbbccbaccaccaabcbaccbaccbcabbabccabbbacccaccbbcacbcbacabacbbcaacbacccaacabccababbbbcabaaacbbbbabbacbcccaabacbbcbbbabcaccbbcbbbbacabbcabbcbcbcbcccabaaccbababcaacaabbccaabaabcaccbacacbcaccbcbbccccabcaaacccacbabcbabaabcacbaaabbabbaabbacaaabcbababbcaccaaccbacccacbaacaacaaabccccacaababcbabaacbacbcabbaababbbbabbaabaccabcacbbaccbabbcccbabaacaacaabccbcbbcbbabcbbcbcbbaaababacbaababcbaacbbcccbbababcccabcaabccbcabbbbcbbacaaaabccbccabccbacccaccaccbccacbbcbbaaabccabaaabcbcbbccccbbcacabbbcabbabcaabacacbbbbbbccabcaccacbbbbaaaabbbabbabacaccccbacbbcbaccbbbbcbcacaabcbaacabccbbccbacaaababbccbbbcabbcacbaaaaacbbcbbcbaaaabbbcccbcacbcbbcabaabccbbcbbabbacbaaaaabbcccabacbbabbbcababbbbacbabbbbcaaabbbccbabaacacbbaabcbbacccccbbabacbbcabcbbacabcbbbaccbbbabacacaaaccbbcabccbbcbcbcbbacbbbbbbccbbcaaabbbbbccbabcabacacacabacacbcacbbbcabcabcbbbbbcbacbaaccababbbabbbaccbccaaccbaababbbccabbaaccabccbabcacbacabbacccbaccaacbcbbaaaacacbbbcccbcabbccbacacccbccbbaaabcccbccbbabcbaaacbaababccbbbbaccbcbacacaababcccabbcaccaaacbcaccbcbbcacaacacaccbcbbcaababbcaacccabaabccccaaaaccbcabcbbcbbababbccabcbcbbcccbbbcaaaccabbacccaacbacbbaacbbcabbbabcccbacbacbbcaabaababbcbabcacabaabbaabacbcccbcabaacbababbcccabcaaacbacaabcabcaaaacabbbcbbaacbcbabaabaccbabccccacaaaccbbbcabaababbcaabacabaaaabacbbbabbaccbbcccbbbacbbabcbaccaaccbaabbbaabccbbcaababbcacbbabbaacaaabaaabababaaccbacaabbcaabaaacbcbbccccacacbccbccabbcabcbacbabaacaacccccbcbbaacbabcaabacacaabccbbbbccbbaacbccbbbcaababbbbcaccaccabccacbabcababcbbccbcacbbaacabbcbbcccacbbabacbbaababcaaccacabbabbabaabcbbbbbabbabccbaccbbbabcaabacccbcbacaacbaabaabcaaaabaabbabbcaaaabbbabcbccaabcbcacbaccccbacaaaacbacacccccaccbbabbaccccaacbbaabaaacacaabccbcaaabbbbccbcbaabbbababacccbcacbbcbcaacabaaababbaccaacaccbcbaaaaaccaacacbcbacbbaaaaabcaacbcbcbaabbacabcbaabcaabbbbaabcbccbcccaaabccaaaacccacacbbbbbcabacbaabbaccccacaacacccccbccbabcababccacabbacacbaabababcbccabcbaaacacbacacabcaaaaaaabaaabacccbccbcbaaabcbbcbacaaaaaaccaccacaaaaaccbcbbbcbbcacbccaaabcabbbaacccacbcbcacaaaaaaabbacccabaaccaaaaababaaccabcccbcbacbbabccacbbccbcaaabbbacabccbaabaccababcabcaccababbcacacbaacbbacabbbbcbbacbaaabcccabcacabcccbabccbbcbabcacbbccbccbaabbbbabcacaacababacbbcaabcabbcbcacbcaacabcaacabbccabccbbabaabbaababacbbaacbbbbaababaacabbcbacabcbbaccbabcabbacacbbbcbacaacbaaacbcbacbabcbacaacbbabaabcbabaabcabccabcbbcbabcbcaaaaccbabccbbccccccaababaaabacbabbbbcbcaccbbbaccbbaababcbbcccacaaaaaaaccacacabccabbaaabaabcbabaccbaccaacaabcbccbcbcbaaccaccaccbabbcbcbcacbacaccccbcbabbcacbbaabbcbbcacccababacbabccbbaccaacabcacacbbaaaccbcaaacbaabbbbbaabbbbbabcaabbccaccaacbbaaaaaaabaacbacaaaabcbbbaaaababacbcaabcbacbcacacacacaaabbbbbaccabbbbcbabaaccbaaaccbbccbccabacababaccbbbabbaabcbaabaaccccbbbbaccaacccccacabacbaaaabbbccaacabbacabcbaaccbabcacabcacbbbcccbaabababccaccacbacbccbbccacaccbccccaacabacccbbacbabacabacabbabcacbaaccbccbccccbabbcbcbbbccbcbcaacabcccbacbbbabbcbbacbcabcbbbcacaacbbaaabbaababacaacbbbcbcaabbcacbcabcccacaaacaabccabbccbbaabbacacabcaaaabaccaaacccbcabaacacbabacacaababcabacbcabaacbacbbabcacbccbaccbbcbaccbbbbccaaccbbabcbabcaccccacbaacabccabcbabaabbacbacaaccbcbbbacaaaabbbbbbabaacbcabaaabaacbbbcbaababcabacbcbbcacccbabbcccaccccbbbbbabaabbaaacaacbcccbbacbaaaccbabbacacbacccbcbbabbbabaccbbcbcabcbabbcbaacccccbccabbbbaabbbcaaacbacccbacccbbaccbcaacababcabcbbcbcabcbacacacbabaabcaaccaaccccaccacbacccacbccbbaacbcbbcccbaccbcccabbbcaccacbabcaccbacacbacaacabcbabcbbcabaaabbbaaaabcaacbabbaacbcbccbcaccccbabaaabbabbacbaccbbacbbababacaaaacaacccaacbccbbbccaaabcabbcacbbacabccbaabaccbaaabbaccccccabaaaabaaacccbbacbbcbaabbacacacabbacaabccbccbcbcbabbccccbccccabcaccacaabaacccbbacccccabbacacabbaabbaaccbcabbbbbaababccbacbaccacaaacbccccbbbbbbcaabbcbabaabcababcaaaabaccbcaaccaaaccbabaacacbcbcbccabcbacacaaaccbaaacbcaaabbacbccabaacabbccccbcabbcbaacbbcabbcacaaccacbbbcacacaaccccbaccbbbaaccbbccbacbaabbacccbbbaccccbacbbbcaaaaacaabbbbacbbaacbccbaabaaaccabcacaccbcccabccabbabcaccbacbababbcbbbaacbcbbbacbbcbcbcaabaaabbbcbcccaccbacabbaabaabbabbcbabcbacbbaccbbcaccbcaaaabcbcccbccccbcabaaacbaaccaaaabcbcbabbbcccacccacbcaccbbbaaabcbabbccaabcbcbbbacbababcbbabcaababaaccabaaabaccccccbccaccbbacacbaacaacaabaabacaaacaabcccbcabcabbcaaabcacacbbcccbbabcbabccababbaabcbacaababacccaacccbbabbbbaccbacbbcacaacaccbbaaabcabbaaccababbcbacbccbcbbcabacbacabbcbabbcbcbaaabbcaacbcacaabcccabbccbbcababbacacbacbccbcbcaaaacabaaaabaabbccaaccaaacaccabcacbccaabccbccabcbbaabcabacacbbbbcabaabaaacaacbbbccccbbbaccabbbccbcacccbccbbbcbcbbaaacbaccbaabbcacbacbaccacbacbccaabcbbaaccacaaabacabbbccaaccbbbcabbaaabacccacacaccbcccccbacccbcaaccbbacbacbabcbbbbaaacbaababbcabaaacacacbcacbbbbcaaababcbcaccbcbacaccaacacbaacbabbaaaabcbbacabcbbbcaacaaacacaccaaccaabcaabbbaaccbcabaccbbbcbaabbccccbbcaaacabcbbbcaaaaccbbbbbcaabcbaabcacccccaacaabbcbbcaacabcbacabcccaacaaaccabbcabcbcbbbbcbbbcacacabacacaaaaccabbbaabbcccbcbcaccacabaaacababaabccbabacaabccaabaaabbbabacabcaaaccababccaababcbabababbbbbaaccaabbabcbcbcacbaaacbbbcbaccbacaaabacabbbacaaabaacaabcaccacabaaabbbbcbbcbbcababaacbcaacbacbbbbbcacccacaabcaacccaccabaabaabcbaccbbcbacbcacbacccabcaaaacbbcbabbbcaccbbbbbaacacbcbcbcaaaabbccaaaabaccbaabcaacabaacbbccbbbacbcbacaacbabaabbcbaccbcbbcbcabbbabbccbbcbabcacabbacbcbbbbaababcabccbbbccbbbbacbbaabcabbabbcaabacbcbbccccacbbbbcccbcbbbaabccccbaacaacccbcacacbcccbabbbcacabbbccabaccbcabcccaabcbacaccabbabccbbcabbcbababaaaacbaaacbabaabacabcbcaaaabbaaaccbbababcbbccaaccaacaaccacbabbbcccbaabbcabbcbbcaababaacbccbabaabccabccbcababcbbaccbbbabacbabacbcbcaccabaccbccccaaacbbccbbacbaccaccbcbbcccccbccbbaccbccabbcaacccaccbbabaabcaabacabcccbacbacbccaabbcccbccbbaaacbccbcaabbbaacacabcabbaccaccbaaabaaccbbabacbcbacbccccbbaabcabbcbcaccaacbccbbccbbbbacbccccaabaabbcbabbbcabbabcbcbbaaacaabccaccbcaccaaaabcbacbabbcccbacbababcbaabccbbbcbbaccbabbccccbaabbcbbcbaaababacbcabaacbaabbbccacbccbacbccccbacbabaaabbccccacbaabcbcaccbbccababbccaccaaaabbcabbbbbbabaababccbcaabcbaaaaaabaabacacaacccaabacbcbbabbcbaabacaaaaccccaacbbccaaabbaacbccabaabaccabcbbcacabcbacbccbbcbcaccbbaaaccbbcbaccbbcbcbcaccccaabcacabbccaccabcccccababbacbbbabbbacabbbcacaabbacbbbbbabacbbbccbbaababaccbbbbbbbabccaaabbbbcbcacbbbbbbbcabcccacabbaaacabaaacaababbbccccaabcacaaaaabaabcbaccaacacbabcbccbccaccbbbabaaabbbaaaabcaacbabbaaccbacbbaaccbcbabcbbabacbbabacbccabcbccacacabacbabccaaaaababbaacbccacababaccbcabccabcacbbbbbccbabcacbaabcbaccccababcabbccabbbbcacbaccacaabcabcccaaacacbccacbbaabcabcbbaabbbcbaaabbaabbaabcbabababccbabccccaaaaabcccbbababccaccaabbabbccabccbbbbacaaabaacbbccbbbbbbaaaabacabacaaccbbaaacbbcbccbbacbcabbccaabbabbccbcbbacbaaabacbacababcacabccaabaccbbbbaaaabcbbabbaabacbcababacbacccaaabcabcbacaaacbaccbcaaaabccacaaacbbbbbcacaacaccaacabaccbccabbbccbbbccccbbaacabbbcaabacaabaccbaacabccbbccbbcbabbabccaccbccbbbccbccaabbccbcaccaaaacaacaccacacabbbcbaabbaaccabccaaacaabbbaccbcacabbaaacaaccbcaaabcbcbababbcbbabaaabbbccbcacabbcbbccbbbccbaabbbbaaaccbccccbbaaacacbbcccaaaabaaacacabbabcaaabccabcbccbcbcabbaccabcaaacbccaabbabaaacaacbaaacbbcabbabcbcabcbacaabbacccbaaabbcaaacacaaabbbbaabcbcbbbabacbabacaccbacbcbabbaababaccccaccaabacbaaabcaaccbaaabbaaacaaacaccccbcaabbcacaaabbacbcacabbbbcbaaabbbaabccabbaaaaacbbaabccbabacacaaccbaccaacabcaaabacabbcccbccbbabacbbabcbcbbababacccbbbcbccccccbabccabcabbccabbbbcccaabcbabaacacabccbababbaaabacacbaaaabbcbcbbabbccabccaababccacbcbccacbcacbccabacbaaacaccccbaaacbccbacbbaaaccabaaacacbaaabbcaaaaaaaababbbbaacbbcccbaabbbcccaaabbbbbcaabacabcabcaccabaccbcaacabbbcacbaacaaacabcccabcbbbbbaacabcbcccbcbbbabcbccabacabbaabbbbaaabaccccacacabbbbaacbabccbcbccbbacbbcacbbcabcabacababccbbbcabababccbacbbbccaacaaabccccccabcbbbbbacbccabbacbccababbbcbcbccababbcccaababbcababacbacaaababcccbcbaaabcbbcabbcbccbcccbcbbcabaabaacbccacbccaabbabaacaccacccccaabcbbbaabacbbaabbbcacbbabcabcacbacbcabccacbccbcbaaabacbccbcbbacaaacbbcbcbbcaacaabccbabbbbccaccbcaababbbccacabbbcbcabcbaaccabcaccbcaabcbbcbcbacbbacbcbbcaacbcccbccccabbacbcacacaaababbbcbccacbccccbcbaaaacacbbccaabaccaaacabcabccbabaccbacabcbcbbbcbbbcacababbabbcbacbaaaaabbcbcabcaacabcacacbcbcaacacbbabccabcbbbcbcbccbccbabccaacaaccabbbbacbbccbbbbacbaccbcbbabbacbbbcacacbbacabccaccbcaabcbcbbacbcbbcacbbcabbcacccacbacacbabbcccabaaccaabbaacabcbabcbbbaaaabbaaaccccacaaabacacccccaaacabbccbcaacaabbcccbccaacaabaaaabaabaababaccaccbcabaccbacccbcacbcacbbcbbbbaacabbbbabcaccccabccabcbabaacbacacbcabaaccacaaabcbcccbbbbacaccabbbabbacbabacbccbcbbabccabbaabacbaacccbababccbabaabcaaccaaabbabbcbaabbbcbcaaaaccbccabbcccabbbcbaaaaaaacbcabbaacccbaacbacaaccabbbccbcacacaacaaaccbbbbccabaacbabacaccababcbcabbccabcbcbaabbbcbbcacaaaabacaaccbaccbabcbccbabaacccccbaabcbcabaaaabababbacaacabcaccbbbcaacbbacbbababaaccacbbcbaccccacabbcbcccabcccbcbbabaccbcabaaabababbcccbacabccbabcacaaacaaacbaccbcbccaaaacacabbbcbbaacbcacabcabbabcacbaacccbcaccbbacabcccbbacbacaccccbcbcbaabbaccccbabbababccbccabacabcbaaabaaabcabbbaacaaabcaacaabbbcbcacccccccbaacababcbcbbbbbabccbbcabbaaabaccbacbaaacacabacbabbaabbabccabbabbbaabcabbabcbacbccaabcbabcbbcabcbabaaaaacabaccaacccabcbacacbbababcaacacacbabbaaaaccbccaccaaacbccbcabaacabaaccbacacabcccacbaccacbacbcccabbaabcbbbcbabaccbcacbccbbbacbcccababaaacaacbccccbcbbaccbabcabccabbbbccaaaccbababcccbbcabccbccbbcbbbcbcaacccccbbabacbacacaabacbcccbccbaabbcaccababccbbbaacbbcacabaccabacacbacbcccbcaabaabbaaabcbcbcabcbbcbbbccbccacaccccccccbacbacacbabacacabccbabbaccbcabbbcccbcaacacacbacabcaabcccabccbcbabcbcbcaccbacaaaabcabbbbbcabcbbaaacccbabbacbccccbcbbcbabbccacccbbcbccbaaaccbcaccccccccbabcccccccbabbabcccccccaaabcccabbcaaaaabbcbbabbcabbacacaaacbaaaccaaababcbbcacbbcbacaccccbbaccbcbcbabbbababbbbcccacaabaacaabbbcccaacaaabcacbbcacacbbccaaacaaababcaaacbccbbbbbbcbaabbbcabcccbabcaacbcacabcaacbacacaaabccccacacaaabcacaccacbbbcbaaccbbcacbcaaaccacbbbbabaabccbccbaaccabababcacbaaaaccccabaabccccbaaccbccbabbaccbbbaacacabbbacbacbbbcbacbbbbaabbbacccccbabaabcbccabaaabaacaacbbbbccaccbaabccabcbbbbabbccacabaccbaccbccacbaccbccccacaaacacbabacbcccbccababccaabcbabbccaccbccbacacaaccaccabcbaabcabbcbbbbbcaccacabbbaacbcabbcbbaccbabbbccaaabccbbccbaabbaccabcbabbcabbaccacaaacbabcbaacbaaccacabacbcccccbabaaaccbccbbcaaabaccccbacbbacabbcbcbcabbabbacbbbbabcabcabcccbabbabcbabbccbaabbabacaabaccacbcabaaaaaacbbbbacbbaccaacaaabbbacaaaaabbcbcbcbabbccccacbbabbabcbbabbabaacccbbabbbabbbccbabacabcabbaacbbabcccccacbabababaaccabbbbccbabbaaacbbbbacbbcccbabcaaccbccaaababbaaaacabbbbcabababbccbbcacbbaccaabbabaaacbbccbaaabaacbbaabccacbccbbbabcbccaccbbacacbabcaccccaabbcbcababcabaacbaaabcabacabacacaccbacbcaccbaacabcacacbacacaccccbbabcacabbbbaccbbccccbbaabbbaccbacccbaaccacacccacbccbcbcbcabccacacaacacaaccbabbccbacbacacabababcaaccbccbaacabacbcacabccccaaccbcaacaabcbccaacbbabacbacccaacacbcacbabcbbcbcbabbcaaacbbcbacabcaabbcbcbbcbacbbcbabbaaacbabbbccbbbbbbabccabbbcabbbbbcaccbacbcbaccaccabbbcacbacbcbbabbbbabbbccbcaccbcbbcccaaaccbabaaaccaabcbccaababaccacbabcabbcbacbabbcccbbacaccacacaaacaaaccbccbaaaccaacabbbcbbccccbaaaccbbccbcccbbcaccacccacaacababacbcbacacacbaaaccacbcaaaaacaaaababbbaaaccbbbaaaaacacbcaacacabaaabbbbbaacababbcccccbbbacabacbcabbbabcabcaccabacbaaabaccacaccbbaccbacacbccbcbcbabbbacababacabbbcbaccccbababcabccaacacbbcabbbacbccaccbbccabbaccaabbaaabaabacbaccbbbcbcbaacbcbcbcbcbccbccacbaacbabaabcabbcacccbccbacbbbbcaacbabababbaabbbcbbabbbbcbbbbacbcccabaaabacbaabacbccaaacacccbaccbbbaababbabccacbababbbcbacacbbaababccabccbcbbbacbbcbaabbcbbcabcaacccbcacaabbaaaccccbccbaacbababbcacbbacaccabbcaabababbccbabacaccbcaaccacaaacababbbababbacbbaccbbacabbaaccabacbbccbbaabaccabcbacbbbcaabbcacabcbbbabaacacaaaaaaccabbbbccccbabcabbaabacbabcabaaacaabccaabbcacaacabacabaabaabcbccaabcaacbbccbbacbabcccbaccacaccccaaccaaabcababbacccbcbcbcbbbaacbacabbcccaabcabbcabbcbbcbacbbbcabcaacaacaaccbbabcccbacbbbbcaabcaccababacaaababbbabaabcaaabbcaacaacaabcaacbabbbacbaacccabbcaaccbabcbbabbabbbabaaacaabccabbabaacbcaccbcbaacccbcacabbabcbaccacccaccaacccaabccccccbbbbbaabbbcacabcbaabcbabacbbbcbcaaacacbbbbcacbbaaaccbccbbbbbbabccabbabaacaaccbcccacaacababbbacabbaccccbacccbcccccabaaccabbbaaaccbbbbaccababcbcaabcabacbbaccbacaabacbaccbacccacabacabbbccaacbaabcabbcbbcccbbbbcbbcbaaacbabaabcbccbaccbabbbcacbcacbaaccaaabccbaabcbbabcbbabcccacabbcbcabcbbcbcccbabbabbabccabaabbcabaabaacbccaabbcabaaccaccccacbabccbbbacabcccacbbbabcbbcacabacbcababcaabacabbccacabbaabacbbbbccacccabaacaacacccbbbabaacccabaacbcabcaaaaccacccccabaabcbaabaabacacbbbacbbbabbaababcaccccbccaabbcbacbcbcababaccaaaabaabaaccccaccabbbbbccbcbbbacacccbabccabbaacccabccccabacbcabacbcbabbbcbcbbcccbccabcccccccacaacbbcbccbaabcacbcbcacccbcccbcaabbccbacababcbaabbbbaacbacacacbccbaccbabbccbbbbbaaccabcacbabcaaaabcaaacbbaabbcaccabcacbbbccacababbbaabccabaaabacbaacbbaabacabcbaaacbabbaacabccacbbbacccbbcbcacacbaccccabbabbbaacaaaaacbbccabaccbabcbcbcaacbabbccacbbbcbccbabacaacacacbabbcbbbcaaacccaccbccaaacaaaabbaabaaaccccbabcbcccabbabaabbbbcbaabababcbabaabcabcbacacbbccccabacbbcbbaabbabcabbacccbbcbcababbcabcbacabcabbabacbacacaabcccabcbccbabccabbbbabaaccbacccbbbabbbcbbaccccaacabbcaabababbbcacccbcbacbbacabaaabbacaccbabbcabbabcbccbbcacbacabbbcccaaabbacabbbcbabbaaccabaabaacacbbabccccbcabbacccbccbccacababcbacbaccbbbaabaccbacbaccbabcaccbbbbcbbbaaacbbababbbbabbcbbabcccbcababbacaaabaaabcbcbcbbbbbabcaabbcbababacbbaacbcbabbbbcccbbcbaccccbaaaccaabcacbbacbaccccbbcaaaccaacbabbacacbaacacabbccbbaaccbaabccaaaaabcccbbcbcacbcbbbaacbaacaaabccaaaccccccacbaccccbbcbabaaababacbcbcabaabcbcaccbbbaabaccbbbbbbbccbbcccbaacbcbcabbbccacccacaccaabbbbabcaaabaabacccccbabacccabaabbabbccccbcbbaabbcbccbabaaacabcabacbcbbbaaaabccaccacccaaccbacbcbcaabacbcccbbacabbaccbacaaabacaaabbbaccabcbbcacbabbaabcbbcbbcabbbbcbbbcabaaacbcbbcabcabcbabbbbccabbaacccacabacbcacacbbbcaaccbabbcbbcacaaaabbacacbcaaaaabcabaaabccbcbbbccbbbbaabbabaaabbacabbccccbaabccccbbaababccbaabbaaabbbaababacbcaaabcbbbcacaababbabcbcbabaacaccbcccbabaccbbaabaabcbccacbbaaccbcbaaccbaaaccbbbbcbaaacaabcabbacbcccacacbbcababbabccccaccbbbcccabaabbacaaccbbacbabacbcbbccbcabcccababaacabaacaaaabcbabbccbaaccccaaccbcabcbaabcbaacacacaaaabbbcacbaabacccbccbccaaaabacaccaacaccabbabcaccacaabbbabcabbcbbabbabbaaacbaaacabaacabcabcabbabaaaacbbbbbcbaaaaabbbaaaaccacbcabaababcbbbcaabbcbaccaaacccccbbbcaabcbccbbbacabccacbaccaccaacbbccacbbcbcccabcacbabcbcacacbaaabacbababaacbcbcbcaaabaabbbaabbcccbaabaabbaabccbcaccbabaaabbaabccabababcbbaabbbaaccbbabbaaabbabcabaccaccabaaccaccbcacaaabbababbcccbcbacbabacccacbacacacbacacbabbbacccccabcabcbacccaaaaccbabbacaabbbcbcaaabaacaababacbabababcccacacbbbaaaababaaacaabaaacacabcbcabbaaacbcbcbbccbabbaccaaaaccbabbcccabcacbcacbbabcabcbcabbababccaccbcbcacaabbababbbbbaaaabccbccbacbaccaacbbcabaccbbcacabaaacbcacbbbcaacaaccaaaaaaaaccbbcaabaababcaaabcbaccabccacacbacacaccccbaccbacbaaabbaabacaaabbcabcbcacccbbbaaaabcbcbaaaaabaabccaaaaabbbaabcaabbbabccbbbaccbccaccaaacaabbbbbcaacaaccacbabccbacccbacbababcabcbacbccbabcbacccaccbbccbbccababbccbcccbbcccccaccbcbcaaaacbcaacbbacabcaaabbaacbccaabcbaaabcbbaaccaabababaacbbbbabbabbabbcccaccaaabcaaccccccaaabbabaccabcbbacbcbacaacbbcacaaaacbbbccabaaacbcbbccaccaacacaaabcabbbccccabbcbcaabcbcbbbbcbabacaaaabbcbbccbbbaabacbccbcabcabbaabbcacaaaccaabcabbbbbcaabaacaacaccaabbccccbccaacacbcccacbccacacbacbacccbbabcacccbcababccbaacabccbcaaaaacbcaccbabcbbcacabbbbacabcbacbbbaababcccaabbbabbbcacabcbaacabbabcacabbbcbbbaaacbacabbcaabacbbbabbaaaccccbbabacaabcbaaccabbacbcabcaacbacbccaacbbacacaababbaccbbacabbacbbaacbccbcccacabcccbbaabccacabcaabbaacacaccacacbcabbabccaacbacaccaaabbaaccbacccbccccbbbbbcabaacccccccbbabbabbcbaabcbaaaaabccacbbacabcccbcabacbabaccbcaaccabccabccabacccacacbabbbaaacccbccccbcbababababaabcbcbbaabbbbacacbcccbcbabacaabccccabbbcbaccbccabcbcbbaabaacbcabaacaabcccbabccbaaacbababaaaccacaabacaaabbacccaacccacbcabbbbaabcabccbbacbaabbbaccbcbcbbbbcaacbccccbccacbacccabcbbcbbaccaaccaaacacccccabcbbcaccbcccabccbbabbccbbaccaccbbbbbabbbacaacbbacaaabbbccbaaabbaacbccbababbabbbaabaaacaccbbcccacbcbaaaacaabbaabaabcbccbbbacbbccbbaaabbccbbcbaaaaacababbaabcacaabcacbacaaaababccbbbababcabbcbacbcaabccbacaaaabcbaababacaaaccaccbabcbcbcbcababccabccaabcbcccbbabaccaacacaacbcaaacabcbbbabbbaccacbabccbbbacbbaacbacbbbcbccbcabcccacccbcbcaaabaaabbccaccbcabbcabccbccaccacbabaabccccccbbbacacbbbbbabcccbcbabbbccacabcaccccbccccbbcccaabccbccabcacbabbbcbcaaccbbacbabaaaccaaaabbbaacbccccbccabcaaccccacbabbaabcbbbccaacbcacabbcaabbabacabcabcbbbcccbbbcacbccaabcbbccbcccbcbaccbbcbaccccacbccbabbccbbcbcabbcccacbaabbaccbcbacbcbbccaccbcbcbbaacbcabcbcabaccabbbabccacbccaacabcbabcaaaacccbcbbcbbbcabacbcbcbbacbaaaabccabccaabababaccabcbbaaacccccbcbbbabbabcbaabccccaacccbbbbcacbaaccaaacaabbabacababbacccacbaabacccbbacaacbaacccbbabacabcbbcaccbabbabaaaccaabcabbbbbaccbcaaaaaccccbacabaabbcbcbccaacabababbbabcbbacacacbbcbbbaaaaccabcababbbcbaaacccccacacabccaabaaaabbbabbabcaccaaabbacaabbaaccbabacabaccabbaaacaccbacbbbbcabcaabcbbaacbbcacbaacbacbaacbaccabbcccbbcbccacaccbbaabbaaccbcabcbcbabbacabbcabccabcaccabcbcbcccaabcbbcacacccaccbbbaababbacbaccbababcbacccacabcababcaccaaacaababccbbabaccaacacabacbcbccaacbcaacacabaabbacaccbaabccaacbcacabbbaacacccbacaaaccabcaabccacabbbaaacccbcbcccaaabbabacbabccabbcaaabccabccbbcbabbaababcccacacbbabccccaaabaccaccccabbcabcaccabbccacbbccccaccbcacccbbaaaaabbbabbbcacaacacbbcccabbbbbcbbbbaabbcbbccaacaaaacbcbcbcccaaccbbccaaabbbcabbccaacbaaccbaaabcbbaccacaaaabbcbbabbcccbcacabcccaaaabcaabccacbccbbaacaacabbaabcaacbbabccaaabacaccaacacbbcccbbbbbaabacbaabbcabaabaabcaabbbabccbcaccbbbccccbbbbbbaaccabaacbcbbbbaabacacabbbaabccaaaaccccababccaabccbabacabbaccbccbcbacbcccacabbabcaccccccccaaacbbbaabbccacaabaca".to_string();
        assert_eq!(15828, Solution::longest_balanced(s));
    }
}
